# 직장인을 위한 파이썬 기초 7교시 완성형 커리큘럼

> **대상**: 파이썬을 처음 배우는 직장인  
> **총 학습 시간**: 약 7시간  
> **난이도**: 초급~중급  
> **목표**: 실무에서 바로 활용 가능한 파이썬 기초 완성

---

## 📚 전체 커리큘럼 개요

이 커리큘럼은 직장인 눈높이에 맞춰 실무에서 자주 사용하는 파이썬 기능을 중심으로 구성되었습니다.
함수, 파일 처리, 데이터 분석 기초까지 한 번에 학습할 수 있습니다.

---

# 1교시: 함수(Function) - 코드 재사용의 시작

> **학습 목표**: 코드의 재사용성을 높이는 함수(Function) 정의 및 호출 방법 이해  
> **실습 주제**: 원화(KRW)를 입력하면 달러(USD)로 변환하는 환율 계산 함수 만들기

## 1) 이론 설명

### 함수란 무엇인가?

함수는 **특정 작업을 수행하는 코드 묶음**입니다. 마치 회사에서 "결재 요청" 버튼을 누르면 
자동으로 문서가 상사에게 전달되는 것처럼, 함수를 호출하면 미리 정의해둔 작업이 자동으로 실행됩니다.

**직장인 비유**:
- **함수 정의**: 업무 매뉴얼 작성 (한 번만 작성)
- **함수 호출**: 매뉴얼대로 업무 실행 (여러 번 재사용)

### 함수를 사용하는 이유

1. **코드 재사용**: 같은 코드를 여러 번 작성하지 않아도 됨
2. **유지보수 용이**: 수정이 필요할 때 한 곳만 고치면 됨
3. **가독성 향상**: 복잡한 코드를 의미 있는 이름으로 정리
4. **협업 효율**: 팀원들이 만든 함수를 쉽게 활용

### 함수의 기본 구조

```python
def 함수이름(매개변수):
    """함수 설명 (docstring)"""
    # 실행할 코드
    return 결과값
```

- **def**: 함수 정의 키워드 (define의 약자)
- **함수이름**: 의미 있는 이름 사용 (동사 형태 권장)
- **매개변수**: 함수에 전달하는 입력값 (parameter)
- **return**: 함수 실행 결과를 반환

### 실제 예시로 이해하기

**예시 1: 매개변수가 없는 함수**
```python
def say_hello():
    """인사말을 출력하는 함수"""
    print("안녕하세요!")
    print("좋은 하루 되세요!")

# 함수 호출
say_hello()
```

**예시 2: 매개변수가 있는 함수**
```python
def greet_employee(name):
    """직원에게 인사하는 함수"""
    print(f"{name}님, 안녕하세요!")
    print("오늘도 화이팅입니다!")

# 함수 호출
greet_employee("김철수")
greet_employee("이영희")
```

**예시 3: 반환값이 있는 함수**
```python
def calculate_bonus(salary, performance):
    """성과급을 계산하는 함수
    
    Args:
        salary: 기본급
        performance: 성과 점수 (0.0 ~ 1.0)
    
    Returns:
        계산된 성과급
    """
    bonus = salary * performance
    return bonus

# 함수 호출 및 결과 저장
my_bonus = calculate_bonus(3000000, 0.15)
print(f"이번 달 성과급: {my_bonus:,.0f}원")
```

## 2) 실습 예제 코드

### 메인 실습: 환율 계산 함수

```python
# ========================================
# 1교시 실습: 환율 계산 함수
# ========================================

def krw_to_usd(krw_amount):
    """원화를 달러로 변환하는 함수
    
    Args:
        krw_amount: 원화 금액 (단위: 원)
    
    Returns:
        달러 금액 (단위: USD)
    """
    # 환율 설정: 1 USD = 1,400 KRW
    exchange_rate = 1400
    
    # 달러 계산
    usd_amount = krw_amount / exchange_rate
    
    return usd_amount


# 함수 사용 예제
print("=" * 50)
print("환율 계산기 (KRW → USD)")
print("=" * 50)

# 100,000원을 달러로 변환
krw1 = 100000
usd1 = krw_to_usd(krw1)
print(f"{krw1:,}원 = ${usd1:.2f}")

# 500,000원을 달러로 변환
krw2 = 500000
usd2 = krw_to_usd(krw2)
print(f"{krw2:,}원 = ${usd2:.2f}")

# 1,000,000원을 달러로 변환
krw3 = 1000000
usd3 = krw_to_usd(krw3)
print(f"{krw3:,}원 = ${usd3:.2f}")
```

### 추가 예제: 양방향 환율 계산

```python
def usd_to_krw(usd_amount):
    """달러를 원화로 변환하는 함수
    
    Args:
        usd_amount: 달러 금액 (단위: USD)
    
    Returns:
        원화 금액 (단위: 원)
    """
    exchange_rate = 1400
    krw_amount = usd_amount * exchange_rate
    return krw_amount


# 양방향 변환 테스트
print("\n" + "=" * 50)
print("양방향 환율 계산")
print("=" * 50)

# 원화 → 달러
print(f"200,000원 = ${krw_to_usd(200000):.2f}")

# 달러 → 원화
print(f"$100 = {usd_to_krw(100):,.0f}원")
```

### 응용 예제: 여행 경비 계산

```python
def calculate_travel_budget(days, daily_budget_usd):
    """여행 경비를 원화로 계산하는 함수
    
    Args:
        days: 여행 일수
        daily_budget_usd: 하루 예산 (USD)
    
    Returns:
        총 여행 경비 (원)
    """
    total_usd = days * daily_budget_usd
    total_krw = usd_to_krw(total_usd)
    return total_krw


# 여행 경비 계산
print("\n" + "=" * 50)
print("여행 경비 계산기")
print("=" * 50)

trip_days = 7
daily_cost = 200  # 하루 $200

total_cost = calculate_travel_budget(trip_days, daily_cost)
print(f"{trip_days}일 여행 예상 경비: {total_cost:,.0f}원")
print(f"(하루 예산: ${daily_cost})")
```

## 3) 코드 설명

### 환율 계산 함수 분석

```python
def krw_to_usd(krw_amount):  # ← 함수 정의 시작
    exchange_rate = 1400     # ← 지역 변수 (함수 안에서만 사용)
    usd_amount = krw_amount / exchange_rate  # ← 계산 수행
    return usd_amount        # ← 결과 반환
```

**핵심 포인트**:

1. **함수 이름**: `krw_to_usd` - 무엇을 하는지 명확함
2. **매개변수**: `krw_amount` - 변환할 원화 금액
3. **지역 변수**: `exchange_rate`, `usd_amount` - 함수 내부에서만 사용
4. **반환값**: 계산된 달러 금액

### 함수 호출 과정

```python
usd1 = krw_to_usd(100000)
```

1. `krw_to_usd` 함수 호출
2. `krw_amount`에 `100000` 전달
3. 함수 내부에서 계산 수행
4. 결과값 반환
5. `usd1` 변수에 저장

### return의 역할

```python
# return이 있는 함수
def add(a, b):
    return a + b

result = add(5, 3)  # result = 8

# return이 없는 함수
def print_sum(a, b):
    print(a + b)

result = print_sum(5, 3)  # 화면에 8 출력, result = None
```

**차이점**:
- `return`이 있으면: 결과를 변수에 저장하거나 다른 곳에 사용 가능
- `return`이 없으면: 단순히 작업만 수행 (출력, 파일 저장 등)

## 4) 실습 미션

### 미션 1: 연봉 계산기 (난이도: ★☆☆)

월급을 입력받아 연봉을 계산하는 함수를 작성하세요.

**요구사항**:
- 함수명: `calculate_annual_salary`
- 매개변수: `monthly_salary` (월급)
- 반환값: 연봉 (월급 × 12)

```python
# 여기에 함수를 작성하세요
def calculate_annual_salary(monthly_salary):
    # 코드를 작성하세요
    pass

# 테스트
print(calculate_annual_salary(3000000))  # 36000000 출력
```

### 미션 2: 근무 시간 계산기 (난이도: ★★☆)

출근 시간과 퇴근 시간을 입력받아 근무 시간을 계산하는 함수를 작성하세요.

**요구사항**:
- 함수명: `calculate_work_hours`
- 매개변수: `start_hour`, `end_hour` (정수, 24시간 형식)
- 반환값: 근무 시간 (시간)

```python
# 여기에 함수를 작성하세요
def calculate_work_hours(start_hour, end_hour):
    # 코드를 작성하세요
    pass

# 테스트
print(calculate_work_hours(9, 18))  # 9시 출근, 18시 퇴근 → 9시간
```

### 미션 3: 할인가 계산기 (난이도: ★★★)

원가와 할인율을 입력받아 최종 가격을 계산하는 함수를 작성하세요.

**요구사항**:
- 함수명: `calculate_discount_price`
- 매개변수: `original_price` (원가), `discount_rate` (할인율, 0~1 사이)
- 반환값: 할인 후 가격

**예시**: 100,000원 상품에 20% 할인 → 80,000원

```python
# 여기에 함수를 작성하세요
def calculate_discount_price(original_price, discount_rate):
    # 코드를 작성하세요
    pass

# 테스트
print(calculate_discount_price(100000, 0.2))  # 80000.0 출력
```

## 5) 퀴즈

### 퀴즈 1 (객관식)
다음 중 함수를 정의할 때 사용하는 키워드는?

1. function
2. def
3. define
4. func

### 퀴즈 2 (객관식)
다음 코드의 출력 결과는?

```python
def multiply(x, y):
    return x * y

result = multiply(5, 3)
print(result)
```

1. 8
2. 15
3. 53
4. None

### 퀴즈 3 (단답형)
함수에서 결과값을 반환할 때 사용하는 키워드는 무엇인가요?

## 6) 정답 및 해설

### 미션 정답

**미션 1 정답**:
```python
def calculate_annual_salary(monthly_salary):
    """월급을 연봉으로 변환"""
    annual_salary = monthly_salary * 12
    return annual_salary

# 또는 간단하게
def calculate_annual_salary(monthly_salary):
    return monthly_salary * 12
```

**해설**: 연봉은 월급 × 12개월입니다. 간단한 곱셈 연산을 수행하고 결과를 반환합니다.

**미션 2 정답**:
```python
def calculate_work_hours(start_hour, end_hour):
    """근무 시간 계산"""
    work_hours = end_hour - start_hour
    return work_hours
```

**해설**: 퇴근 시간에서 출근 시간을 빼면 근무 시간이 됩니다.

**미션 3 정답**:
```python
def calculate_discount_price(original_price, discount_rate):
    """할인가 계산"""
    discount_amount = original_price * discount_rate
    final_price = original_price - discount_amount
    return final_price

# 또는 한 줄로
def calculate_discount_price(original_price, discount_rate):
    return original_price * (1 - discount_rate)
```

**해설**: 
- 할인 금액 = 원가 × 할인율
- 최종 가격 = 원가 - 할인 금액
- 또는 최종 가격 = 원가 × (1 - 할인율)

### 퀴즈 정답

**퀴즈 1 정답**: 2. def

**해설**: 파이썬에서 함수를 정의할 때는 `def` 키워드를 사용합니다. "define"의 약자입니다.

**퀴즈 2 정답**: 2. 15

**해설**: multiply(5, 3)은 5 × 3 = 15를 반환합니다.

**퀴즈 3 정답**: return

**해설**: `return` 키워드는 함수의 실행 결과를 호출한 곳으로 반환합니다.

---

# 2교시: 텍스트 파일 읽기/쓰기

> **학습 목표**: 파이썬에서 텍스트(.txt) 형식의 파일 읽기/쓰기 방법 이해  
> **실습 주제**: 오늘의 목표를 입력받아 텍스트 파일에 자동 저장하는 프로그램 작성

## 1) 이론 설명

### 파일 처리가 중요한 이유

직장에서는 데이터를 파일로 저장하고 읽는 작업이 매우 빈번합니다:
- **회의록** 저장
- **일일 업무 보고서** 작성
- **로그 파일** 분석
- **데이터 백업** 및 복원

파이썬으로 파일을 다룰 수 있으면 이런 작업을 자동화할 수 있습니다!

### 파일 열기 모드

파일을 열 때는 **목적에 맞는 모드**를 선택해야 합니다:

| 모드 | 의미 | 설명 | 직장인 비유 |
|------|------|------|-------------|
| `'r'` | Read | 읽기 전용 | 보고서 열람 |
| `'w'` | Write | 쓰기 (덮어쓰기) | 새 문서 작성 (기존 내용 삭제) |
| `'a'` | Append | 추가 쓰기 | 문서 끝에 내용 추가 |
| `'x'` | Exclusive | 새 파일 생성 (이미 있으면 에러) | 신규 문서만 생성 |

### 파일 처리의 기본 패턴

```python
# 기본 방법 (수동으로 닫기)
file = open('파일명.txt', '모드')
file.write('내용')
file.close()  # 반드시 닫아야 함!

# 권장 방법 (자동으로 닫기)
with open('파일명.txt', '모드') as file:
    file.write('내용')
# with 블록을 벗어나면 자동으로 닫힘
```

**왜 `with`를 사용해야 할까?**
- 파일을 자동으로 닫아줌 (실수 방지)
- 에러가 발생해도 안전하게 처리
- 코드가 더 깔끔함

### 파일 쓰기 예제

```python
# 파일에 한 줄 쓰기
with open('memo.txt', 'w') as f:
    f.write('오늘의 할 일: 보고서 작성\n')

# 여러 줄 쓰기
with open('memo.txt', 'w') as f:
    f.write('1. 이메일 확인\n')
    f.write('2. 회의 준비\n')
    f.write('3. 보고서 작성\n')
```

### 파일 읽기 예제

```python
# 전체 내용 읽기
with open('memo.txt', 'r') as f:
    content = f.read()
    print(content)

# 한 줄씩 읽기
with open('memo.txt', 'r') as f:
    for line in f:
        print(line.strip())  # strip()으로 줄바꿈 문자 제거
```

### 한글 인코딩 문제 해결

윈도우에서 한글 파일을 읽을 때 깨질 수 있습니다. 이럴 때는 인코딩을 지정하세요:

```python
# UTF-8 인코딩으로 파일 열기 (권장)
with open('한글파일.txt', 'r', encoding='utf-8') as f:
    content = f.read()
```

## 2) 실습 예제 코드

### 메인 실습: 오늘의 목표 저장 프로그램

```python
# ========================================
# 2교시 실습: 오늘의 목표 저장 프로그램
# ========================================

import datetime

def save_daily_goal(goal):
    """오늘의 목표를 파일에 저장하는 함수
    
    Args:
        goal: 목표 내용 (문자열)
    """
    # 오늘 날짜 가져오기
    today = datetime.date.today()
    date_str = today.strftime('%Y-%m-%d')  # 예: 2024-03-15
    
    # 파일명 생성
    filename = f'daily_goal_{date_str}.txt'
    
    # 파일에 저장
    with open(filename, 'w', encoding='utf-8') as f:
        f.write(f"📅 날짜: {date_str}\n")
        f.write("=" * 50 + "\n")
        f.write(f"🎯 오늘의 목표:\n")
        f.write(f"{goal}\n")
        f.write("=" * 50 + "\n")
        f.write("✅ 완료 시 체크: [ ]\n")
    
    print(f"✅ 목표가 '{filename}' 파일에 저장되었습니다!")


def read_daily_goal(filename):
    """저장된 목표 파일을 읽어서 출력하는 함수
    
    Args:
        filename: 읽을 파일명
    """
    try:
        with open(filename, 'r', encoding='utf-8') as f:
            content = f.read()
            print("\n" + "=" * 50)
            print("📄 저장된 목표 내용:")
            print("=" * 50)
            print(content)
    except FileNotFoundError:
        print(f"❌ '{filename}' 파일을 찾을 수 없습니다.")


# 프로그램 실행
print("=" * 50)
print("📝 오늘의 목표 저장 프로그램")
print("=" * 50)

# 목표 입력
my_goal = input("오늘의 목표를 입력하세요: ")

# 목표 저장
save_daily_goal(my_goal)

# 저장된 파일명 생성
today = datetime.date.today()
saved_filename = f'daily_goal_{today.strftime("%Y-%m-%d")}.txt'

# 저장된 내용 확인
print("\n저장된 내용을 확인하시겠습니까? (y/n): ", end='')
choice = input()

if choice.lower() == 'y':
    read_daily_goal(saved_filename)
```

### 추가 예제 1: 업무 일지 작성

```python
def write_work_log(task_list):
    """업무 일지를 파일에 추가하는 함수
    
    Args:
        task_list: 완료한 업무 목록 (리스트)
    """
    filename = 'work_log.txt'
    
    # 현재 시간
    now = datetime.datetime.now()
    timestamp = now.strftime('%Y-%m-%d %H:%M:%S')
    
    # 파일에 추가 (append 모드)
    with open(filename, 'a', encoding='utf-8') as f:
        f.write(f"\n[{timestamp}] 업무 일지\n")
        f.write("-" * 40 + "\n")
        for i, task in enumerate(task_list, 1):
            f.write(f"{i}. {task}\n")
        f.write("-" * 40 + "\n")
    
    print(f"✅ 업무 일지가 '{filename}'에 추가되었습니다.")


# 사용 예
tasks = [
    "이메일 50건 처리 완료",
    "고객 미팅 2건 진행",
    "주간 보고서 작성"
]

write_work_log(tasks)
```

### 추가 예제 2: 파일 내용 검색

```python
def search_in_file(filename, keyword):
    """파일에서 특정 키워드가 포함된 줄 찾기
    
    Args:
        filename: 검색할 파일명
        keyword: 찾을 키워드
    """
    try:
        with open(filename, 'r', encoding='utf-8') as f:
            lines = f.readlines()
            
        print(f"\n'{keyword}'가 포함된 줄:")
        print("=" * 50)
        
        found = False
        for i, line in enumerate(lines, 1):
            if keyword in line:
                print(f"[{i}줄] {line.strip()}")
                found = True
        
        if not found:
            print("검색 결과가 없습니다.")
            
    except FileNotFoundError:
        print(f"❌ '{filename}' 파일을 찾을 수 없습니다.")


# 사용 예
search_in_file('work_log.txt', '보고서')
```

## 3) 코드 설명

### with문의 동작 원리

```python
with open('file.txt', 'w') as f:
    f.write('내용')
# 여기서 자동으로 f.close() 실행됨
```

**with문의 장점**:
1. 자동 리소스 관리
2. 예외 발생 시에도 안전하게 파일 닫기
3. 코드 간결성

### 파일 쓰기 모드 비교

```python
# 'w' 모드: 기존 내용 삭제하고 새로 쓰기
with open('test.txt', 'w') as f:
    f.write('첫 번째 내용\n')

with open('test.txt', 'w') as f:
    f.write('두 번째 내용\n')  # 첫 번째 내용 사라짐!

# 'a' 모드: 기존 내용 유지하고 끝에 추가
with open('test.txt', 'a') as f:
    f.write('추가 내용\n')  # 기존 내용 뒤에 추가됨
```

### 예외 처리의 중요성

```python
# 나쁜 예: 파일이 없으면 프로그램 중단
content = open('없는파일.txt', 'r').read()  # ❌ 에러 발생

# 좋은 예: 에러 처리
try:
    with open('없는파일.txt', 'r') as f:
        content = f.read()
except FileNotFoundError:
    print("파일이 없습니다. 새로 만들까요?")
```

## 4) 실습 미션

### 미션 1: 메모 추가 프로그램 (난이도: ★☆☆)

사용자가 입력한 메모를 `memo.txt` 파일에 계속 추가하는 프로그램을 작성하세요.

**요구사항**:
- 함수명: `add_memo`
- 매개변수: `memo` (메모 내용)
- 기능: 파일 끝에 메모 추가 (날짜/시간 포함)

```python
import datetime

def add_memo(memo):
    # 코드를 작성하세요
    pass

# 테스트
add_memo("회의 준비하기")
add_memo("보고서 작성")
```

### 미션 2: 파일 줄 수 세기 (난이도: ★★☆)

텍스트 파일의 총 줄 수를 세는 함수를 작성하세요.

**요구사항**:
- 함수명: `count_lines`
- 매개변수: `filename` (파일명)
- 반환값: 줄 수 (정수)

```python
def count_lines(filename):
    # 코드를 작성하세요
    pass

# 테스트
print(count_lines('memo.txt'))  # 줄 수 출력
```

### 미션 3: 회의록 템플릿 생성기 (난이도: ★★★)

회의록 템플릿을 자동으로 생성하는 프로그램을 작성하세요.

**요구사항**:
- 함수명: `create_meeting_template`
- 매개변수: `meeting_title`, `date`, `participants` (참석자 리스트)
- 기능: 회의록 양식 파일 생성

**템플릿 형식**:
```
회의록
================
제목: [회의 제목]
날짜: [날짜]
참석자: [참석자1], [참석자2], ...
================

1. 회의 안건

2. 논의 내용

3. 결정 사항

4. 향후 일정
```

```python
def create_meeting_template(meeting_title, date, participants):
    # 코드를 작성하세요
    pass

# 테스트
create_meeting_template(
    "분기별 성과 검토",
    "2024-03-15",
    ["김철수", "이영희", "박민수"]
)
```

## 5) 퀴즈

### 퀴즈 1 (객관식)
파일을 읽기 전용으로 열 때 사용하는 모드는?

1. 'w'
2. 'r'
3. 'a'
4. 'x'

### 퀴즈 2 (객관식)
다음 중 파일을 자동으로 닫아주는 방법은?

1. `open()` 함수 사용
2. `with` 문 사용
3. `close()` 함수 사용
4. `del` 명령어 사용

### 퀴즈 3 (단답형)
파일에 내용을 추가(덮어쓰지 않고)할 때 사용하는 모드는 무엇인가요?

## 6) 정답 및 해설

### 미션 정답

**미션 1 정답**:
```python
import datetime

def add_memo(memo):
    """메모를 파일에 추가"""
    now = datetime.datetime.now()
    timestamp = now.strftime('%Y-%m-%d %H:%M:%S')
    
    with open('memo.txt', 'a', encoding='utf-8') as f:
        f.write(f"[{timestamp}] {memo}\n")
    
    print("✅ 메모가 추가되었습니다.")
```

**해설**: `'a'` 모드를 사용하여 기존 내용을 유지하면서 새 메모를 추가합니다.

**미션 2 정답**:
```python
def count_lines(filename):
    """파일의 줄 수 세기"""
    try:
        with open(filename, 'r', encoding='utf-8') as f:
            lines = f.readlines()
            return len(lines)
    except FileNotFoundError:
        print(f"'{filename}' 파일이 없습니다.")
        return 0
```

**해설**: `readlines()`로 모든 줄을 리스트로 읽은 후 `len()`으로 개수를 셉니다.

**미션 3 정답**:
```python
def create_meeting_template(meeting_title, date, participants):
    """회의록 템플릿 생성"""
    filename = f'meeting_{date}.txt'
    participants_str = ', '.join(participants)
    
    with open(filename, 'w', encoding='utf-8') as f:
        f.write("회의록\n")
        f.write("=" * 50 + "\n")
        f.write(f"제목: {meeting_title}\n")
        f.write(f"날짜: {date}\n")
        f.write(f"참석자: {participants_str}\n")
        f.write("=" * 50 + "\n\n")
        f.write("1. 회의 안건\n\n")
        f.write("2. 논의 내용\n\n")
        f.write("3. 결정 사항\n\n")
        f.write("4. 향후 일정\n\n")
    
    print(f"✅ 회의록 템플릿이 '{filename}'에 생성되었습니다.")
```

**해설**: f-string과 `join()` 메서드를 활용하여 깔끔한 템플릿을 생성합니다.

### 퀴즈 정답

**퀴즈 1 정답**: 2. 'r'

**해설**: `'r'`은 Read(읽기) 모드입니다.

**퀴즈 2 정답**: 2. `with` 문 사용

**해설**: `with` 문을 사용하면 블록을 벗어날 때 자동으로 파일이 닫힙니다.

**퀴즈 3 정답**: 'a' (또는 append)

**해설**: `'a'` 모드는 파일 끝에 내용을 추가합니다.

---

# 3교시: CSV 파일 처리

> **학습 목표**: csv 라이브러리를 활용하여 CSV 파일 데이터 읽고 쓰는 방법 이해  
> **실습 주제**: customers.csv 파일(예: 이름, 나이)을 읽어 파이썬 리스트로 변환하는 코드 작성

## 1) 이론 설명

### CSV란 무엇인가?

**CSV (Comma-Separated Values)**: 쉼표로 구분된 값들의 파일 형식

**직장인이 자주 마주치는 CSV 예시**:
- 엑셀에서 "다른 이름으로 저장" → CSV 형식
- 고객 명단, 매출 데이터, 재고 현황
- 데이터베이스 내보내기 파일

**CSV 파일 예시** (customers.csv):
```
이름,나이,직급
김철수,35,대리
이영희,28,사원
박민수,42,과장
```

### 엑셀 vs CSV

| 특징 | 엑셀 (.xlsx) | CSV (.csv) |
|------|--------------|------------|
| 형식 | 바이너리 (복잡) | 텍스트 (단순) |
| 크기 | 큰 편 | 작은 편 |
| 수식/서식 | 지원 | 미지원 |
| 범용성 | 낮음 | 높음 |
| 프로그래밍 | 라이브러리 필요 | 기본 제공 |

**CSV의 장점**:
- 가볍고 빠름
- 모든 프로그램에서 호환
- 간단한 구조로 배우기 쉬움

### CSV 라이브러리 사용법

파이썬은 CSV 파일을 쉽게 다룰 수 있는 `csv` 모듈을 기본 제공합니다.

**CSV 파일 읽기**:
```python
import csv

with open('customers.csv', 'r', encoding='utf-8') as f:
    reader = csv.reader(f)
    for row in reader:
        print(row)  # row는 리스트 형태
```

**CSV 파일 쓰기**:
```python
import csv

data = [
    ['이름', '나이', '직급'],
    ['김철수', '35', '대리'],
    ['이영희', '28', '사원']
]

with open('output.csv', 'w', newline='', encoding='utf-8') as f:
    writer = csv.writer(f)
    writer.writerows(data)  # 여러 행 한 번에 쓰기
```

### DictReader와 DictWriter

딕셔너리 형태로 CSV를 다루면 더 편리합니다!

**DictReader 사용**:
```python
import csv

with open('customers.csv', 'r', encoding='utf-8') as f:
    reader = csv.DictReader(f)
    for row in reader:
        print(row['이름'], row['나이'])  # 키로 접근 가능!
```

**DictWriter 사용**:
```python
import csv

data = [
    {'이름': '김철수', '나이': 35, '직급': '대리'},
    {'이름': '이영희', '나이': 28, '직급': '사원'}
]

with open('output.csv', 'w', newline='', encoding='utf-8') as f:
    fieldnames = ['이름', '나이', '직급']
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    
    writer.writeheader()  # 헤더 쓰기
    writer.writerows(data)  # 데이터 쓰기
```

## 2) 실습 예제 코드

### 메인 실습: 고객 데이터 읽기

```python
# ========================================
# 3교시 실습: CSV 파일 읽기
# ========================================

import csv

# 먼저 샘플 CSV 파일 생성
def create_sample_csv():
    """샘플 고객 데이터 CSV 파일 생성"""
    customers = [
        ['이름', '나이', '직급', '부서'],
        ['김철수', '35', '대리', '영업팀'],
        ['이영희', '28', '사원', '기획팀'],
        ['박민수', '42', '과장', '개발팀'],
        ['최지우', '31', '대리', '인사팀'],
        ['정다은', '26', '사원', '마케팅팀']
    ]
    
    with open('customers.csv', 'w', newline='', encoding='utf-8') as f:
        writer = csv.writer(f)
        writer.writerows(customers)
    
    print("✅ 'customers.csv' 파일이 생성되었습니다.\n")


def read_csv_to_list(filename):
    """CSV 파일을 읽어 리스트로 변환
    
    Args:
        filename: CSV 파일명
    
    Returns:
        고객 정보 리스트
    """
    customers = []
    
    try:
        with open(filename, 'r', encoding='utf-8') as f:
            reader = csv.reader(f)
            header = next(reader)  # 첫 줄은 헤더
            
            print(f"📋 헤더: {header}\n")
            print("=" * 60)
            print(f"{'이름':^10} {'나이':^8} {'직급':^10} {'부서':^10}")
            print("=" * 60)
            
            for row in reader:
                customers.append(row)
                print(f"{row[0]:^10} {row[1]:^8} {row[2]:^10} {row[3]:^10}")
            
            print("=" * 60)
            print(f"\n총 {len(customers)}명의 고객 데이터를 읽었습니다.")
            
        return customers
        
    except FileNotFoundError:
        print(f"❌ '{filename}' 파일을 찾을 수 없습니다.")
        return []


def read_csv_to_dict_list(filename):
    """CSV 파일을 딕셔너리 리스트로 변환
    
    Args:
        filename: CSV 파일명
    
    Returns:
        고객 정보 딕셔너리 리스트
    """
    customers = []
    
    try:
        with open(filename, 'r', encoding='utf-8') as f:
            reader = csv.DictReader(f)
            
            for row in reader:
                customers.append(dict(row))
            
            print("\n📊 딕셔너리 형태로 변환:")
            print("=" * 60)
            for customer in customers:
                print(customer)
            print("=" * 60)
            
        return customers
        
    except FileNotFoundError:
        print(f"❌ '{filename}' 파일을 찾을 수 없습니다.")
        return []


# 프로그램 실행
print("=" * 60)
print("CSV 파일 처리 실습")
print("=" * 60 + "\n")

# 1. 샘플 CSV 파일 생성
create_sample_csv()

# 2. CSV를 리스트로 읽기
customers_list = read_csv_to_list('customers.csv')

# 3. CSV를 딕셔너리 리스트로 읽기
customers_dict = read_csv_to_dict_list('customers.csv')

# 4. 특정 조건 검색 (나이가 30세 이상인 고객)
print("\n🔍 30세 이상 고객 검색:")
print("=" * 60)
for customer in customers_dict:
    if int(customer['나이']) >= 30:
        print(f"{customer['이름']} - {customer['나이']}세 ({customer['직급']})")
```

### 추가 예제 1: CSV 파일 쓰기

```python
def write_employees_csv():
    """직원 정보를 CSV 파일로 저장"""
    employees = [
        {'사번': 'E001', '이름': '홍길동', '부서': '개발팀', '연봉': 50000000},
        {'사번': 'E002', '이름': '김영희', '부서': '디자인팀', '연봉': 45000000},
        {'사번': 'E003', '이름': '이철수', '부서': '영업팀', '연봉': 48000000}
    ]
    
    with open('employees.csv', 'w', newline='', encoding='utf-8') as f:
        fieldnames = ['사번', '이름', '부서', '연봉']
        writer = csv.DictWriter(f, fieldnames=fieldnames)
        
        writer.writeheader()
        writer.writerows(employees)
    
    print("✅ 'employees.csv' 파일이 생성되었습니다.")


write_employees_csv()
```

### 추가 예제 2: CSV 데이터 분석

```python
def analyze_sales_csv(filename):
    """매출 CSV 파일 분석
    
    Args:
        filename: 매출 CSV 파일명
    """
    total_sales = 0
    sales_by_product = {}
    
    with open(filename, 'r', encoding='utf-8') as f:
        reader = csv.DictReader(f)
        
        for row in reader:
            product = row['제품명']
            sales = int(row['판매금액'])
            
            total_sales += sales
            
            if product in sales_by_product:
                sales_by_product[product] += sales
            else:
                sales_by_product[product] = sales
    
    print("\n📊 매출 분석 결과:")
    print("=" * 60)
    print(f"총 매출액: {total_sales:,}원")
    print("\n제품별 매출:")
    for product, sales in sales_by_product.items():
        print(f"  - {product}: {sales:,}원")
    print("=" * 60)


# 샘플 매출 데이터 생성
sales_data = [
    ['제품명', '판매금액', '판매일'],
    ['노트북', '1200000', '2024-03-01'],
    ['마우스', '30000', '2024-03-01'],
    ['노트북', '1200000', '2024-03-02'],
    ['키보드', '80000', '2024-03-02']
]

with open('sales.csv', 'w', newline='', encoding='utf-8') as f:
    writer = csv.writer(f)
    writer.writerows(sales_data)

analyze_sales_csv('sales.csv')
```

## 3) 코드 설명

### csv.reader vs csv.DictReader

```python
# csv.reader - 리스트로 반환
with open('data.csv', 'r') as f:
    reader = csv.reader(f)
    for row in reader:
        print(row[0], row[1])  # 인덱스로 접근

# csv.DictReader - 딕셔너리로 반환
with open('data.csv', 'r') as f:
    reader = csv.DictReader(f)
    for row in reader:
        print(row['이름'], row['나이'])  # 키로 접근 (더 명확!)
```

**언제 무엇을 사용할까?**
- **리스트 형태 (csv.reader)**: 간단한 데이터, 순서만 중요할 때
- **딕셔너리 형태 (DictReader)**: 복잡한 데이터, 가독성 중요할 때 (권장)

### newline='' 파라미터의 역할

```python
# CSV 쓰기 시 newline='' 사용
with open('data.csv', 'w', newline='', encoding='utf-8') as f:
    writer = csv.writer(f)
```

**왜 필요한가?**
- 윈도우에서 불필요한 빈 줄이 생기는 것을 방지
- CSV 표준에 맞게 줄바꿈 처리

### 헤더 처리 방법

```python
# 방법 1: next()로 헤더 건너뛰기
with open('data.csv', 'r') as f:
    reader = csv.reader(f)
    header = next(reader)  # 첫 줄 읽기
    for row in reader:      # 두 번째 줄부터 데이터
        print(row)

# 방법 2: DictReader 사용 (자동 헤더 처리)
with open('data.csv', 'r') as f:
    reader = csv.DictReader(f)  # 자동으로 첫 줄을 키로 사용
    for row in reader:
        print(row)
```

## 4) 실습 미션

### 미션 1: 제품 재고 CSV 만들기 (난이도: ★☆☆)

제품 재고 정보를 CSV 파일로 저장하는 함수를 작성하세요.

**요구사항**:
- 함수명: `create_inventory_csv`
- 매개변수: `products` (제품 정보 리스트)
- 파일명: `inventory.csv`
- 컬럼: 제품명, 수량, 단가

```python
def create_inventory_csv(products):
    # 코드를 작성하세요
    pass

# 테스트
products = [
    {'제품명': '볼펜', '수량': 100, '단가': 500},
    {'제품명': '공책', '수량': 50, '단가': 2000},
    {'제품명': '지우개', '수량': 80, '단가': 300}
]

create_inventory_csv(products)
```

### 미션 2: CSV 필터링 (난이도: ★★☆)

CSV 파일에서 특정 조건을 만족하는 데이터만 추출하는 함수를 작성하세요.

**요구사항**:
- 함수명: `filter_csv_by_age`
- 매개변수: `filename`, `min_age` (최소 나이)
- 반환값: 조건을 만족하는 고객 리스트

```python
def filter_csv_by_age(filename, min_age):
    # 코드를 작성하세요
    pass

# 테스트
result = filter_csv_by_age('customers.csv', 30)
print(result)
```

### 미션 3: CSV 집계 함수 (난이도: ★★★)

CSV 파일에서 부서별 평균 나이를 계산하는 함수를 작성하세요.

**요구사항**:
- 함수명: `calculate_average_age_by_dept`
- 매개변수: `filename`
- 반환값: 부서별 평균 나이 딕셔너리

```python
def calculate_average_age_by_dept(filename):
    # 코드를 작성하세요
    pass

# 테스트
result = calculate_average_age_by_dept('customers.csv')
print(result)  # {'영업팀': 35.0, '기획팀': 28.0, ...}
```

## 5) 퀴즈

### 퀴즈 1 (객관식)
CSV는 무엇의 약자인가요?

1. Computer System Values
2. Comma-Separated Values
3. Character String Variables
4. Common Storage Version

### 퀴즈 2 (객관식)
다음 중 CSV 파일을 딕셔너리 형태로 읽는 클래스는?

1. csv.reader
2. csv.DictReader
3. csv.writer
4. csv.DictWriter

### 퀴즈 3 (단답형)
CSV 파일 쓰기 시 윈도우에서 빈 줄이 생기는 것을 방지하기 위해 open() 함수에 추가해야 하는 파라미터는?

## 6) 정답 및 해설

### 미션 정답

**미션 1 정답**:
```python
import csv

def create_inventory_csv(products):
    """제품 재고 CSV 파일 생성"""
    with open('inventory.csv', 'w', newline='', encoding='utf-8') as f:
        fieldnames = ['제품명', '수량', '단가']
        writer = csv.DictWriter(f, fieldnames=fieldnames)
        
        writer.writeheader()
        writer.writerows(products)
    
    print("✅ 'inventory.csv' 파일이 생성되었습니다.")
```

**해설**: `DictWriter`를 사용하여 딕셔너리 리스트를 CSV로 변환합니다.

**미션 2 정답**:
```python
import csv

def filter_csv_by_age(filename, min_age):
    """특정 나이 이상의 고객만 추출"""
    filtered_customers = []
    
    with open(filename, 'r', encoding='utf-8') as f:
        reader = csv.DictReader(f)
        
        for row in reader:
            if int(row['나이']) >= min_age:
                filtered_customers.append(dict(row))
    
    return filtered_customers
```

**해설**: `DictReader`로 읽어서 나이 조건을 확인하고, 조건을 만족하는 행만 리스트에 추가합니다.

**미션 3 정답**:
```python
import csv

def calculate_average_age_by_dept(filename):
    """부서별 평균 나이 계산"""
    dept_ages = {}  # {부서: [나이 리스트]}
    
    with open(filename, 'r', encoding='utf-8') as f:
        reader = csv.DictReader(f)
        
        for row in reader:
            dept = row['부서']
            age = int(row['나이'])
            
            if dept in dept_ages:
                dept_ages[dept].append(age)
            else:
                dept_ages[dept] = [age]
    
    # 평균 계산
    dept_avg = {}
    for dept, ages in dept_ages.items():
        dept_avg[dept] = sum(ages) / len(ages)
    
    return dept_avg
```

**해설**: 먼저 부서별로 나이를 모으고, 각 부서의 평균을 계산합니다.

### 퀴즈 정답

**퀴즈 1 정답**: 2. Comma-Separated Values

**해설**: CSV는 쉼표로 구분된 값들을 의미합니다.

**퀴즈 2 정답**: 2. csv.DictReader

**해설**: `DictReader`는 CSV의 각 행을 딕셔너리로 읽습니다.

**퀴즈 3 정답**: newline=''

**해설**: `open()` 함수에 `newline=''` 파라미터를 추가하면 윈도우에서 빈 줄이 생기지 않습니다.

---

# 4교시: JSON 데이터 처리

> **학습 목표**: JSON 데이터 구조 이해 및 파이썬에서 다루는 방법 학습  
> **실습 주제**: JSON 형식 문자열을 파이썬 딕셔너리로 변환 후 고객 이름만 출력하는 코드 작성

## 1) 이론 설명

### JSON이란?

**JSON (JavaScript Object Notation)**: 데이터를 저장하고 전송하기 위한 경량 텍스트 형식

**직장인이 JSON을 만나는 상황**:
- 웹 API에서 데이터 받기 (날씨, 주식, 뉴스 등)
- 설정 파일 (프로그램 설정 저장)
- 데이터베이스와 통신
- 웹 개발 (프론트엔드 ↔ 백엔드)

**JSON의 특징**:
- 사람이 읽기 쉬움
- 기계가 파싱하기 쉬움
- 대부분의 프로그래밍 언어 지원
- 텍스트 기반 (UTF-8)

### JSON vs Python 자료형 비교

| JSON | Python | 예시 |
|------|--------|------|
| 객체 `{}` | 딕셔너리 `{}` | `{"name": "홍길동"}` |
| 배열 `[]` | 리스트 `[]` | `[1, 2, 3]` |
| 문자열 | 문자열 | `"Hello"` |
| 숫자 | int, float | `123`, `3.14` |
| true/false | True/False | `true` → `True` |
| null | None | `null` → `None` |

### JSON 데이터 예시

```json
{
  "customer_id": "C001",
  "name": "김철수",
  "age": 35,
  "email": "kim@example.com",
  "is_vip": true,
  "orders": [
    {"product": "노트북", "price": 1200000},
    {"product": "마우스", "price": 30000}
  ]
}
```

### Python에서 JSON 다루기

파이썬의 `json` 모듈은 JSON 데이터를 쉽게 처리할 수 있게 해줍니다.

**JSON 문자열 → Python 객체 (파싱)**:
```python
import json

json_string = '{"name": "홍길동", "age": 30}'
data = json.loads(json_string)  # loads = load string
print(data['name'])  # 홍길동
```

**Python 객체 → JSON 문자열 (직렬화)**:
```python
import json

data = {"name": "홍길동", "age": 30}
json_string = json.dumps(data, ensure_ascii=False)  # dumps = dump string
print(json_string)  # {"name": "홍길동", "age": 30}
```

**JSON 파일 읽기**:
```python
import json

with open('data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)  # load = load from file
```

**JSON 파일 쓰기**:
```python
import json

data = {"name": "홍길동", "age": 30}

with open('data.json', 'w', encoding='utf-8') as f:
    json.dump(data, f, ensure_ascii=False, indent=2)  # dump = dump to file
```

### ensure_ascii와 indent 옵션

```python
import json

data = {"이름": "김철수", "나이": 35}

# ensure_ascii=False: 한글을 그대로 표시
# indent=2: 들여쓰기로 보기 좋게 정렬
json_str = json.dumps(data, ensure_ascii=False, indent=2)
print(json_str)
```

**출력**:
```json
{
  "이름": "김철수",
  "나이": 35
}
```

## 2) 실습 예제 코드

### 메인 실습: JSON 데이터 파싱

```python
# ========================================
# 4교시 실습: JSON 데이터 처리
# ========================================

import json

def parse_customer_json(json_string):
    """JSON 형식 문자열에서 고객 이름 추출
    
    Args:
        json_string: JSON 형식의 고객 데이터
    
    Returns:
        고객 이름 리스트
    """
    # JSON 문자열을 Python 딕셔너리로 변환
    data = json.loads(json_string)
    
    # 고객 이름 추출
    customer_names = []
    
    if 'customers' in data:
        for customer in data['customers']:
            customer_names.append(customer['name'])
    
    return customer_names


# 샘플 JSON 데이터
json_data = '''
{
  "company": "ABC 상사",
  "customers": [
    {
      "id": "C001",
      "name": "김철수",
      "age": 35,
      "email": "kim@example.com"
    },
    {
      "id": "C002",
      "name": "이영희",
      "age": 28,
      "email": "lee@example.com"
    },
    {
      "id": "C003",
      "name": "박민수",
      "age": 42,
      "email": "park@example.com"
    }
  ]
}
'''

print("=" * 60)
print("JSON 데이터 처리 실습")
print("=" * 60 + "\n")

# JSON 파싱
names = parse_customer_json(json_data)

print("📋 고객 이름 목록:")
print("=" * 60)
for i, name in enumerate(names, 1):
    print(f"{i}. {name}")
print("=" * 60)

# 전체 데이터도 확인
print("\n📊 전체 고객 정보:")
print("=" * 60)
data = json.loads(json_data)
print(f"회사명: {data['company']}")
print(f"\n총 고객 수: {len(data['customers'])}명\n")

for customer in data['customers']:
    print(f"고객 ID: {customer['id']}")
    print(f"이름: {customer['name']}")
    print(f"나이: {customer['age']}세")
    print(f"이메일: {customer['email']}")
    print("-" * 60)
```

### 추가 예제 1: JSON 파일로 고객 정보 저장

```python
def save_customers_to_json(customers, filename):
    """고객 정보를 JSON 파일로 저장
    
    Args:
        customers: 고객 정보 리스트
        filename: 저장할 파일명
    """
    data = {
        "updated_at": "2024-03-15",
        "total_count": len(customers),
        "customers": customers
    }
    
    with open(filename, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)
    
    print(f"✅ '{filename}' 파일에 저장되었습니다.")


# 고객 데이터
customers = [
    {
        "id": "C001",
        "name": "홍길동",
        "age": 30,
        "membership": "Gold",
        "purchase_history": [
            {"date": "2024-01-15", "amount": 150000},
            {"date": "2024-02-20", "amount": 200000}
        ]
    },
    {
        "id": "C002",
        "name": "김영희",
        "age": 25,
        "membership": "Silver",
        "purchase_history": [
            {"date": "2024-02-10", "amount": 80000}
        ]
    }
]

# JSON 파일로 저장
save_customers_to_json(customers, 'customers.json')

# 저장된 파일 읽기
print("\n📖 저장된 파일 내용 확인:")
print("=" * 60)
with open('customers.json', 'r', encoding='utf-8') as f:
    content = f.read()
    print(content)
```

### 추가 예제 2: 웹 API 응답 처리 시뮬레이션

```python
def process_api_response(json_response):
    """API 응답 JSON 처리
    
    Args:
        json_response: API에서 받은 JSON 문자열
    """
    try:
        data = json.loads(json_response)
        
        if data['status'] == 'success':
            print("✅ API 호출 성공!")
            print(f"\n조회 결과: {data['count']}건")
            print("=" * 60)
            
            for item in data['results']:
                print(f"상품명: {item['product_name']}")
                print(f"가격: {item['price']:,}원")
                print(f"재고: {item['stock']}개")
                print("-" * 60)
        else:
            print(f"❌ API 호출 실패: {data['message']}")
            
    except json.JSONDecodeError:
        print("❌ JSON 파싱 오류!")
    except KeyError as e:
        print(f"❌ 필수 키가 없습니다: {e}")


# 가상의 API 응답
api_response = '''
{
  "status": "success",
  "count": 3,
  "results": [
    {"product_name": "노트북", "price": 1200000, "stock": 5},
    {"product_name": "마우스", "price": 30000, "stock": 20},
    {"product_name": "키보드", "price": 80000, "stock": 15}
  ]
}
'''

print("\n🌐 API 응답 처리:")
print("=" * 60)
process_api_response(api_response)
```

### 추가 예제 3: JSON과 CSV 변환

```python
import json
import csv

def json_to_csv(json_filename, csv_filename):
    """JSON 파일을 CSV로 변환
    
    Args:
        json_filename: 입력 JSON 파일
        csv_filename: 출력 CSV 파일
    """
    # JSON 파일 읽기
    with open(json_filename, 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    # CSV로 변환
    if 'customers' in data and len(data['customers']) > 0:
        # 첫 번째 고객의 키를 헤더로 사용
        fieldnames = data['customers'][0].keys()
        
        with open(csv_filename, 'w', newline='', encoding='utf-8') as f:
            writer = csv.DictWriter(f, fieldnames=fieldnames)
            writer.writeheader()
            
            for customer in data['customers']:
                # 복잡한 데이터는 문자열로 변환
                row = {}
                for key, value in customer.items():
                    if isinstance(value, (list, dict)):
                        row[key] = json.dumps(value, ensure_ascii=False)
                    else:
                        row[key] = value
                writer.writerow(row)
        
        print(f"✅ JSON → CSV 변환 완료: '{csv_filename}'")


# 사용 예
json_to_csv('customers.json', 'customers_from_json.csv')
```

## 3) 코드 설명

### json.loads() vs json.load()

```python
import json

# loads: JSON 문자열 → Python 객체
json_string = '{"name": "홍길동"}'
data1 = json.loads(json_string)  # 's' = string

# load: JSON 파일 → Python 객체
with open('data.json', 'r') as f:
    data2 = json.load(f)  # 파일 객체 전달
```

**기억법**:
- `loads`: load **s**tring (문자열에서)
- `load`: load from **file** (파일에서)

### json.dumps() vs json.dump()

```python
import json

data = {"name": "홍길동"}

# dumps: Python 객체 → JSON 문자열
json_string = json.dumps(data)  # 's' = string

# dump: Python 객체 → JSON 파일
with open('data.json', 'w') as f:
    json.dump(data, f)  # 파일 객체 전달
```

### 중첩된 JSON 데이터 접근

```python
import json

json_data = '''
{
  "company": {
    "name": "ABC 상사",
    "employees": [
      {"name": "김철수", "dept": "개발팀"},
      {"name": "이영희", "dept": "디자인팀"}
    ]
  }
}
'''

data = json.loads(json_data)

# 중첩된 데이터 접근
company_name = data['company']['name']
first_employee = data['company']['employees'][0]['name']

print(company_name)       # ABC 상사
print(first_employee)     # 김철수
```

## 4) 실습 미션

### 미션 1: JSON 데이터 생성 (난이도: ★☆☆)

학생 정보를 딕셔너리로 만들고 JSON 파일로 저장하는 함수를 작성하세요.

**요구사항**:
- 함수명: `save_student_info`
- 매개변수: `student` (학생 정보 딕셔너리)
- 파일명: `student.json`

```python
def save_student_info(student):
    # 코드를 작성하세요
    pass

# 테스트
student = {
    "name": "홍길동",
    "student_id": "2024001",
    "major": "컴퓨터공학",
    "gpa": 3.8
}

save_student_info(student)
```

### 미션 2: JSON에서 특정 데이터 추출 (난이도: ★★☆)

JSON 파일에서 특정 조건을 만족하는 제품 정보만 추출하는 함수를 작성하세요.

**요구사항**:
- 함수명: `find_expensive_products`
- 매개변수: `json_filename`, `min_price` (최소 가격)
- 반환값: 조건을 만족하는 제품 리스트

```python
def find_expensive_products(json_filename, min_price):
    # 코드를 작성하세요
    pass

# 테스트용 JSON 파일 생성
products_data = {
    "products": [
        {"name": "노트북", "price": 1200000},
        {"name": "마우스", "price": 30000},
        {"name": "모니터", "price": 500000}
    ]
}

with open('products.json', 'w', encoding='utf-8') as f:
    json.dump(products_data, f, ensure_ascii=False)

# 함수 테스트
result = find_expensive_products('products.json', 100000)
print(result)
```

### 미션 3: 설정 파일 관리 (난이도: ★★★)

프로그램 설정을 JSON 파일로 저장하고 불러오는 클래스를 작성하세요.

**요구사항**:
- 클래스명: `ConfigManager`
- 메서드: `save_config()`, `load_config()`, `get_setting()`

```python
class ConfigManager:
    def __init__(self, config_file='config.json'):
        self.config_file = config_file
        self.config = {}
    
    def save_config(self, config):
        """설정을 JSON 파일로 저장"""
        # 코드를 작성하세요
        pass
    
    def load_config(self):
        """JSON 파일에서 설정 불러오기"""
        # 코드를 작성하세요
        pass
    
    def get_setting(self, key, default=None):
        """특정 설정값 가져오기"""
        # 코드를 작성하세요
        pass

# 테스트
config_mgr = ConfigManager()
config_mgr.save_config({
    "theme": "dark",
    "language": "ko",
    "auto_save": True
})

config_mgr.load_config()
print(config_mgr.get_setting("theme"))  # dark
```

## 5) 퀴즈

### 퀴즈 1 (객관식)
JSON은 무엇의 약자인가요?

1. Java Standard Object Notation
2. JavaScript Object Notation
3. JSON Syntax Object Naming
4. Joint System Object Network

### 퀴즈 2 (객관식)
Python 딕셔너리를 JSON 문자열로 변환할 때 사용하는 함수는?

1. json.load()
2. json.loads()
3. json.dump()
4. json.dumps()

### 퀴즈 3 (단답형)
JSON에서 한글이 깨지지 않도록 하려면 dumps() 함수에 어떤 파라미터를 추가해야 하나요?

## 6) 정답 및 해설

### 미션 정답

**미션 1 정답**:
```python
import json

def save_student_info(student):
    """학생 정보를 JSON 파일로 저장"""
    with open('student.json', 'w', encoding='utf-8') as f:
        json.dump(student, f, ensure_ascii=False, indent=2)
    
    print("✅ 'student.json' 파일에 저장되었습니다.")
```

**해설**: `json.dump()`를 사용하여 딕셔너리를 JSON 파일로 저장합니다.

**미션 2 정답**:
```python
import json

def find_expensive_products(json_filename, min_price):
    """가격이 최소 금액 이상인 제품 찾기"""
    with open(json_filename, 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    expensive = []
    for product in data['products']:
        if product['price'] >= min_price:
            expensive.append(product)
    
    return expensive
```

**해설**: JSON 파일을 읽어 리스트로 변환한 후, 조건에 맞는 제품만 필터링합니다.

**미션 3 정답**:
```python
import json

class ConfigManager:
    def __init__(self, config_file='config.json'):
        self.config_file = config_file
        self.config = {}
    
    def save_config(self, config):
        """설정을 JSON 파일로 저장"""
        self.config = config
        with open(self.config_file, 'w', encoding='utf-8') as f:
            json.dump(config, f, ensure_ascii=False, indent=2)
        print("✅ 설정이 저장되었습니다.")
    
    def load_config(self):
        """JSON 파일에서 설정 불러오기"""
        try:
            with open(self.config_file, 'r', encoding='utf-8') as f:
                self.config = json.load(f)
            print("✅ 설정을 불러왔습니다.")
        except FileNotFoundError:
            print("⚠️ 설정 파일이 없습니다. 기본 설정 사용.")
            self.config = {}
    
    def get_setting(self, key, default=None):
        """특정 설정값 가져오기"""
        return self.config.get(key, default)
```

**해설**: 클래스를 사용하여 설정 관리 기능을 캡슐화합니다.

### 퀴즈 정답

**퀴즈 1 정답**: 2. JavaScript Object Notation

**해설**: JSON은 원래 JavaScript에서 유래했으나 지금은 언어 독립적인 데이터 형식입니다.

**퀴즈 2 정답**: 4. json.dumps()

**해설**: `dumps()`는 Python 객체를 JSON 문자열로 변환합니다.

**퀴즈 3 정답**: ensure_ascii=False

**해설**: `ensure_ascii=False`를 추가하면 한글이 유니코드 이스케이프 없이 그대로 표시됩니다.

---

# 5교시: Pandas 기초 - DataFrame 소개

> **학습 목표**: Pandas 소개 및 데이터프레임(DataFrame) 개념 이해  
> **실습 주제**: 리스트 또는 딕셔너리를 사용해 직접 Pandas 데이터프레임 만들기

## 1) 이론 설명

### Pandas란?

**Pandas**: Python에서 데이터 분석을 위한 가장 인기 있는 라이브러리

**직장인이 Pandas를 사용하는 이유**:
- Excel 작업을 Python으로 자동화
- 대용량 데이터 빠르게 처리
- 복잡한 데이터 분석을 간단하게
- 차트와 그래프 생성

**Pandas의 핵심 개념**:
- **Series**: 1차원 데이터 (엑셀의 한 컬럼)
- **DataFrame**: 2차원 데이터 (엑셀의 시트 전체)

### DataFrame이란?

DataFrame은 **표(테이블) 형태의 데이터 구조**입니다.

**엑셀과 비교**:
| 엑셀 | Pandas DataFrame |
|------|------------------|
| 시트 | DataFrame |
| 행(Row) | Row / Index |
| 열(Column) | Column |
| 셀(Cell) | Value |

**DataFrame의 구조**:
```
     이름   나이  부서
0   김철수   35   영업팀
1   이영희   28   기획팀
2   박민수   42   개발팀
↑    ↑     ↑     ↑
인덱스  컬럼1  컬럼2  컬럼3
```

### Pandas 설치

```bash
pip install pandas
```

### DataFrame 생성 방법

**방법 1: 딕셔너리로 생성**
```python
import pandas as pd

data = {
    '이름': ['김철수', '이영희', '박민수'],
    '나이': [35, 28, 42],
    '부서': ['영업팀', '기획팀', '개발팀']
}

df = pd.DataFrame(data)
print(df)
```

**방법 2: 리스트의 리스트로 생성**
```python
import pandas as pd

data = [
    ['김철수', 35, '영업팀'],
    ['이영희', 28, '기획팀'],
    ['박민수', 42, '개발팀']
]

df = pd.DataFrame(data, columns=['이름', '나이', '부서'])
print(df)
```

**방법 3: 리스트의 딕셔너리로 생성**
```python
import pandas as pd

data = [
    {'이름': '김철수', '나이': 35, '부서': '영업팀'},
    {'이름': '이영희', '나이': 28, '부서': '기획팀'},
    {'이름': '박민수', '나이': 42, '부서': '개발팀'}
]

df = pd.DataFrame(data)
print(df)
```

### Series 이해하기

Series는 DataFrame의 **한 컬럼**입니다.

```python
import pandas as pd

# Series 생성
ages = pd.Series([35, 28, 42], name='나이')
print(ages)

# DataFrame의 한 컬럼 = Series
df = pd.DataFrame({
    '이름': ['김철수', '이영희', '박민수'],
    '나이': [35, 28, 42]
})

age_column = df['나이']  # Series
print(type(age_column))  # <class 'pandas.core.series.Series'>
```

## 2) 실습 예제 코드

### 메인 실습: DataFrame 생성

```python
# ========================================
# 5교시 실습: Pandas DataFrame 생성
# ========================================

import pandas as pd

print("=" * 70)
print("Pandas DataFrame 생성 실습")
print("=" * 70 + "\n")

# ===== 방법 1: 딕셔너리로 생성 =====
print("📊 방법 1: 딕셔너리로 DataFrame 생성")
print("=" * 70)

employee_dict = {
    '사번': ['E001', 'E002', 'E003', 'E004', 'E005'],
    '이름': ['김철수', '이영희', '박민수', '최지우', '정다은'],
    '부서': ['개발팀', '디자인팀', '영업팀', '인사팀', '마케팅팀'],
    '연봉': [50000000, 45000000, 48000000, 42000000, 46000000]
}

df1 = pd.DataFrame(employee_dict)
print(df1)
print()

# ===== 방법 2: 리스트의 리스트로 생성 =====
print("\n📊 방법 2: 리스트의 리스트로 DataFrame 생성")
print("=" * 70)

employee_list = [
    ['E001', '김철수', '개발팀', 50000000],
    ['E002', '이영희', '디자인팀', 45000000],
    ['E003', '박민수', '영업팀', 48000000],
    ['E004', '최지우', '인사팀', 42000000],
    ['E005', '정다은', '마케팅팀', 46000000]
]

df2 = pd.DataFrame(employee_list, columns=['사번', '이름', '부서', '연봉'])
print(df2)
print()

# ===== 방법 3: 리스트의 딕셔너리로 생성 =====
print("\n📊 방법 3: 리스트의 딕셔너리로 DataFrame 생성")
print("=" * 70)

employee_dict_list = [
    {'사번': 'E001', '이름': '김철수', '부서': '개발팀', '연봉': 50000000},
    {'사번': 'E002', '이름': '이영희', '부서': '디자인팀', '연봉': 45000000},
    {'사번': 'E003', '이름': '박민수', '부서': '영업팀', '연봉': 48000000},
    {'사번': 'E004', '이름': '최지우', '부서': '인사팀', '연봉': 42000000},
    {'사번': 'E005', '이름': '정다은', '부서': '마케팅팀', '연봉': 46000000}
]

df3 = pd.DataFrame(employee_dict_list)
print(df3)
print()

# ===== DataFrame 기본 정보 확인 =====
print("\n📋 DataFrame 기본 정보")
print("=" * 70)
print(f"행(Row) 개수: {len(df1)}개")
print(f"열(Column) 개수: {len(df1.columns)}개")
print(f"형태(Shape): {df1.shape}")  # (행, 열)
print(f"컬럼 목록: {df1.columns.tolist()}")
print()

# ===== 특정 컬럼 접근 =====
print("\n🔍 특정 컬럼 접근")
print("=" * 70)
print("이름 컬럼:")
print(df1['이름'])
print()

print("연봉 컬럼:")
print(df1['연봉'])
print()

# ===== 여러 컬럼 선택 =====
print("\n🔍 여러 컬럼 선택")
print("=" * 70)
print(df1[['이름', '부서']])
print()

# ===== 새 컬럼 추가 =====
print("\n➕ 새 컬럼 추가")
print("=" * 70)

# 월급 계산 (연봉 / 12)
df1['월급'] = df1['연봉'] / 12
print(df1)
print()

# 성과급 (연봉의 10%)
df1['성과급'] = df1['연봉'] * 0.1
print("\n성과급 컬럼 추가:")
print(df1)
```

### 추가 예제 1: 월별 매출 데이터프레임

```python
import pandas as pd

# 월별 매출 데이터
monthly_sales = {
    '월': ['1월', '2월', '3월', '4월', '5월', '6월'],
    '매출': [150, 180, 200, 220, 250, 230],
    '목표': [200, 200, 200, 250, 250, 250]
}

df_sales = pd.DataFrame(monthly_sales)

# 목표 달성률 계산
df_sales['달성률(%)'] = (df_sales['매출'] / df_sales['목표'] * 100).round(1)

print("\n📈 월별 매출 현황")
print("=" * 70)
print(df_sales)
print()

# 평균 매출
avg_sales = df_sales['매출'].mean()
print(f"평균 매출: {avg_sales:.1f}만원")

# 최고 매출
max_sales = df_sales['매출'].max()
max_month = df_sales[df_sales['매출'] == max_sales]['월'].values[0]
print(f"최고 매출: {max_month} - {max_sales}만원")
```

### 추가 예제 2: 고객 등급 시스템

```python
import pandas as pd

# 고객 데이터
customers = {
    '고객명': ['김철수', '이영희', '박민수', '최지우', '정다은'],
    '구매금액': [1500000, 800000, 2200000, 500000, 1800000]
}

df_customers = pd.DataFrame(customers)

# 등급 부여 함수
def assign_grade(amount):
    if amount >= 2000000:
        return 'VIP'
    elif amount >= 1000000:
        return 'Gold'
    elif amount >= 500000:
        return 'Silver'
    else:
        return 'Bronze'

# 등급 컬럼 추가
df_customers['등급'] = df_customers['구매금액'].apply(assign_grade)

print("\n👥 고객 등급 시스템")
print("=" * 70)
print(df_customers)
print()

# 등급별 고객 수
print("등급별 고객 수:")
print(df_customers['등급'].value_counts())
```

### 추가 예제 3: Series 활용

```python
import pandas as pd

# Series 생성
print("\n📊 Series 예제")
print("=" * 70)

# 과일 가격 Series
fruits_price = pd.Series(
    [2000, 3000, 1500, 4000],
    index=['사과', '포도', '바나나', '딸기'],
    name='가격'
)

print("과일 가격:")
print(fruits_price)
print()

# Series 연산
print("20% 할인 가격:")
discounted = fruits_price * 0.8
print(discounted)
print()

# Series → DataFrame
df_fruits = pd.DataFrame({
    '과일': fruits_price.index,
    '가격': fruits_price.values
})

print("DataFrame으로 변환:")
print(df_fruits)
```

## 3) 코드 설명

### DataFrame 생성 방법 비교

```python
# 딕셔너리: 컬럼 중심 (같은 컬럼끼리 묶음)
data1 = {
    '이름': ['김철수', '이영희'],
    '나이': [35, 28]
}

# 리스트의 리스트: 행 중심 (한 사람의 정보를 한 행에)
data2 = [
    ['김철수', 35],
    ['이영희', 28]
]

# 리스트의 딕셔너리: 행 중심, 키로 접근 가능
data3 = [
    {'이름': '김철수', '나이': 35},
    {'이름': '이영희', '나이': 28}
]
```

**어떤 방법을 선택할까?**
- **데이터를 한 번에 준비**: 딕셔너리 방식 (권장)
- **데이터를 한 행씩 추가**: 리스트의 딕셔너리
- **CSV 등에서 읽어온 데이터**: 리스트의 리스트

### 컬럼 접근 방법

```python
import pandas as pd

df = pd.DataFrame({
    '이름': ['김철수', '이영희'],
    '나이': [35, 28]
})

# 방법 1: 대괄호 (권장)
names1 = df['이름']

# 방법 2: 속성 접근 (컬럼명에 공백이 없을 때만)
names2 = df.이름

# 여러 컬럼 선택 (대괄호 두 개!)
subset = df[['이름', '나이']]
```

### apply() 함수 활용

```python
import pandas as pd

df = pd.DataFrame({
    '점수': [85, 90, 75, 95]
})

# 각 점수에 함수 적용
def grade(score):
    if score >= 90:
        return 'A'
    elif score >= 80:
        return 'B'
    else:
        return 'C'

df['학점'] = df['점수'].apply(grade)
print(df)
```

## 4) 실습 미션

### 미션 1: 제품 재고 DataFrame 생성 (난이도: ★☆☆)

제품 재고 정보를 DataFrame으로 만드는 함수를 작성하세요.

**요구사항**:
- 함수명: `create_inventory_df`
- 매개변수: 제품 정보 리스트
- 반환값: DataFrame

```python
import pandas as pd

def create_inventory_df(products):
    # 코드를 작성하세요
    pass

# 테스트
products = [
    {'제품명': '볼펜', '수량': 100, '단가': 500},
    {'제품명': '공책', '수량': 50, '단가': 2000},
    {'제품명': '지우개', '수량': 80, '단가': 300}
]

df = create_inventory_df(products)
print(df)
```

### 미션 2: 총액 계산 컬럼 추가 (난이도: ★★☆)

재고 DataFrame에 총액(수량 × 단가) 컬럼을 추가하는 함수를 작성하세요.

**요구사항**:
- 함수명: `add_total_column`
- 매개변수: DataFrame
- 기능: '총액' 컬럼 추가

```python
def add_total_column(df):
    # 코드를 작성하세요
    pass

# 테스트
df = create_inventory_df(products)
add_total_column(df)
print(df)
```

### 미션 3: 학생 성적 분석 (난이도: ★★★)

학생 성적 DataFrame을 만들고 평균, 등급을 추가하는 프로그램을 작성하세요.

**요구사항**:
- 함수명: `analyze_student_scores`
- 매개변수: 학생별 점수 딕셔너리
- 기능: 평균, 등급 컬럼 추가
- 등급 기준: 90 이상 A, 80 이상 B, 70 이상 C, 나머지 D

```python
def analyze_student_scores(scores_dict):
    # 코드를 작성하세요
    # DataFrame 생성, 평균 계산, 등급 부여
    pass

# 테스트
scores = {
    '이름': ['김철수', '이영희', '박민수'],
    '국어': [85, 90, 75],
    '영어': [90, 85, 80],
    '수학': [88, 92, 70]
}

df = analyze_student_scores(scores)
print(df)
```

## 5) 퀴즈

### 퀴즈 1 (객관식)
Pandas에서 2차원 테이블 데이터를 저장하는 자료구조는?

1. Series
2. DataFrame
3. Array
4. List

### 퀴즈 2 (객관식)
DataFrame의 한 컬럼을 선택하면 어떤 타입이 반환되나요?

1. list
2. dict
3. Series
4. DataFrame

### 퀴즈 3 (단답형)
DataFrame을 생성할 때 가장 많이 사용하는 함수는 무엇인가요? (pd._____)

## 6) 정답 및 해설

### 미션 정답

**미션 1 정답**:
```python
import pandas as pd

def create_inventory_df(products):
    """제품 재고 DataFrame 생성"""
    return pd.DataFrame(products)
```

**해설**: 리스트의 딕셔너리를 DataFrame()에 전달하면 자동으로 변환됩니다.

**미션 2 정답**:
```python
def add_total_column(df):
    """총액 컬럼 추가"""
    df['총액'] = df['수량'] * df['단가']
    return df
```

**해설**: DataFrame의 컬럼끼리 연산하면 자동으로 각 행에 대해 계산됩니다.

**미션 3 정답**:
```python
import pandas as pd

def analyze_student_scores(scores_dict):
    """학생 성적 분석"""
    # DataFrame 생성
    df = pd.DataFrame(scores_dict)
    
    # 평균 계산
    df['평균'] = (df['국어'] + df['영어'] + df['수학']) / 3
    df['평균'] = df['평균'].round(1)  # 소수점 1자리
    
    # 등급 부여
    def assign_grade(avg):
        if avg >= 90:
            return 'A'
        elif avg >= 80:
            return 'B'
        elif avg >= 70:
            return 'C'
        else:
            return 'D'
    
    df['등급'] = df['평균'].apply(assign_grade)
    
    return df
```

**해설**: 평균을 계산하고 `apply()` 함수로 등급을 부여합니다.

### 퀴즈 정답

**퀴즈 1 정답**: 2. DataFrame

**해설**: DataFrame은 행과 열로 구성된 2차원 테이블 데이터 구조입니다.

**퀴즈 2 정답**: 3. Series

**해설**: DataFrame의 한 컬럼은 Series 타입입니다.

**퀴즈 3 정답**: DataFrame

**해설**: `pd.DataFrame()`을 사용하여 DataFrame을 생성합니다.

---

# 6교시: Pandas로 CSV 파일 읽기

> **학습 목표**: read_csv()로 CSV 파일을 데이터프레임으로 불러오는 방법 이해  
> **실습 주제**: 로컬에 저장된 대용량 CSV 파일을 데이터프레임으로 불러오는 코드 작성

## 1) 이론 설명

### CSV 파일 읽기의 중요성

**직장에서 자주 마주치는 상황**:
- 엑셀에서 내보낸 CSV 파일 분석
- 데이터베이스에서 추출한 대용량 데이터 처리
- 웹에서 다운로드한 공공 데이터 활용
- 로그 파일 분석

**Pandas를 사용하는 이유**:
- 엑셀보다 훨씬 빠름 (수백만 행도 가능)
- 메모리 효율적
- 다양한 데이터 형식 자동 인식
- 강력한 데이터 조작 기능

### read_csv() 기본 사용법

가장 간단한 형태:
```python
import pandas as pd

df = pd.DataFrame('data.csv')
print(df)
```

### read_csv() 주요 파라미터

| 파라미터 | 설명 | 예시 |
|----------|------|------|
| `filepath` | 파일 경로 (필수) | `'data.csv'` |
| `encoding` | 인코딩 방식 | `'utf-8'`, `'cp949'` |
| `sep` | 구분자 | `','` (기본값), `'\t'` |
| `header` | 헤더 행 번호 | `0` (기본값, 첫 줄) |
| `names` | 컬럼명 직접 지정 | `['이름', '나이']` |
| `index_col` | 인덱스로 사용할 컬럼 | `0` 또는 `'ID'` |
| `usecols` | 읽어올 컬럼 선택 | `['이름', '나이']` |
| `nrows` | 읽어올 행 수 제한 | `1000` |

### 인코딩 문제 해결

한글이 깨질 때는 인코딩을 변경하세요:

```python
# UTF-8 (대부분의 경우)
df = pd.read_csv('data.csv', encoding='utf-8')

# CP949 (윈도우 엑셀에서 저장한 CSV)
df = pd.read_csv('data.csv', encoding='cp949')

# 에러 무시 옵션
df = pd.read_csv('data.csv', encoding='utf-8', errors='ignore')
```

### 대용량 파일 처리 팁

**방법 1: 필요한 컬럼만 읽기**
```python
# 특정 컬럼만 선택
df = pd.read_csv('large_file.csv', usecols=['이름', '나이', '부서'])
```

**방법 2: 행 수 제한**
```python
# 처음 1000행만 읽기
df = pd.read_csv('large_file.csv', nrows=1000)
```

**방법 3: 청크 단위로 읽기**
```python
# 1000행씩 나누어 읽기
chunk_size = 1000
for chunk in pd.read_csv('large_file.csv', chunksize=chunk_size):
    # 각 청크 처리
    print(f"청크 크기: {len(chunk)}")
```

### 다양한 형식의 CSV 읽기

**탭으로 구분된 파일 (TSV)**:
```python
df = pd.read_csv('data.tsv', sep='\t')
```

**세미콜론으로 구분**:
```python
df = pd.read_csv('data.csv', sep=';')
```

**헤더가 없는 파일**:
```python
df = pd.read_csv('data.csv', header=None, names=['이름', '나이', '부서'])
```

## 2) 실습 예제 코드

### 메인 실습: CSV 파일 읽기

```python
# ========================================
# 6교시 실습: Pandas로 CSV 읽기
# ========================================

import pandas as pd

# ===== 샘플 CSV 파일 생성 =====
def create_sample_sales_csv():
    """대용량 매출 데이터 CSV 생성"""
    import random
    from datetime import datetime, timedelta
    
    # 샘플 데이터 생성
    products = ['노트북', '마우스', '키보드', '모니터', '헤드셋']
    customers = ['김철수', '이영희', '박민수', '최지우', '정다은', '한소희', '윤지호']
    
    data = []
    start_date = datetime(2024, 1, 1)
    
    for i in range(1000):  # 1000개 레코드
        record = {
            '주문번호': f'ORD{i+1:04d}',
            '날짜': (start_date + timedelta(days=random.randint(0, 90))).strftime('%Y-%m-%d'),
            '고객명': random.choice(customers),
            '제품명': random.choice(products),
            '수량': random.randint(1, 5),
            '단가': random.choice([30000, 80000, 150000, 500000, 1200000]),
        }
        data.append(record)
    
    # DataFrame 생성 및 총액 계산
    df = pd.DataFrame(data)
    df['총액'] = df['수량'] * df['단가']
    
    # CSV 파일로 저장
    df.to_csv('sales_data.csv', index=False, encoding='utf-8')
    print(f"✅ 'sales_data.csv' 파일이 생성되었습니다. (총 {len(df)}개 레코드)\n")
    
    return df


# ===== CSV 파일 읽기 =====
def read_sales_csv(filename='sales_data.csv'):
    """매출 CSV 파일 읽기"""
    print("=" * 70)
    print("📂 CSV 파일 읽기")
    print("=" * 70 + "\n")
    
    try:
        # CSV 파일 읽기
        df = pd.read_csv(filename, encoding='utf-8')
        
        print(f"✅ '{filename}' 파일을 성공적으로 읽었습니다.")
        print(f"   - 총 행 수: {len(df):,}개")
        print(f"   - 총 열 수: {len(df.columns)}개")
        print(f"   - 컬럼: {', '.join(df.columns)}\n")
        
        return df
        
    except FileNotFoundError:
        print(f"❌ '{filename}' 파일을 찾을 수 없습니다.")
        return None
    except Exception as e:
        print(f"❌ 오류 발생: {e}")
        return None


# ===== 특정 컬럼만 읽기 =====
def read_specific_columns(filename='sales_data.csv'):
    """특정 컬럼만 선택하여 읽기"""
    print("\n📋 특정 컬럼만 읽기")
    print("=" * 70)
    
    columns_to_read = ['주문번호', '날짜', '고객명', '총액']
    df = pd.read_csv(filename, usecols=columns_to_read, encoding='utf-8')
    
    print(f"선택한 컬럼: {', '.join(columns_to_read)}")
    print(f"데이터 크기: {len(df)}행 × {len(df.columns)}열\n")
    print(df.head())
    
    return df


# ===== 일부 행만 읽기 =====
def read_limited_rows(filename='sales_data.csv', n=10):
    """처음 N개 행만 읽기"""
    print(f"\n📊 처음 {n}개 행만 읽기")
    print("=" * 70)
    
    df = pd.read_csv(filename, nrows=n, encoding='utf-8')
    
    print(f"읽어온 데이터: {len(df)}행\n")
    print(df)
    
    return df


# ===== 날짜 컬럼을 datetime으로 자동 변환 =====
def read_with_datetime(filename='sales_data.csv'):
    """날짜 컬럼을 datetime 타입으로 읽기"""
    print("\n📅 날짜 컬럼 자동 변환")
    print("=" * 70)
    
    df = pd.read_csv(
        filename,
        encoding='utf-8',
        parse_dates=['날짜']  # 날짜 컬럼을 datetime으로 변환
    )
    
    print("컬럼 데이터 타입:")
    print(df.dtypes)
    print()
    
    return df


# ===== 프로그램 실행 =====
print("=" * 70)
print("Pandas CSV 파일 읽기 실습")
print("=" * 70 + "\n")

# 1. 샘플 CSV 파일 생성
sample_df = create_sample_sales_csv()

# 2. CSV 파일 읽기 (기본)
df = read_sales_csv('sales_data.csv')

if df is not None:
    # 3. 데이터 미리보기
    print("\n🔍 데이터 미리보기 (처음 5행)")
    print("=" * 70)
    print(df.head())
    
    # 4. 특정 컬럼만 읽기
    df_selected = read_specific_columns('sales_data.csv')
    
    # 5. 일부 행만 읽기
    df_limited = read_limited_rows('sales_data.csv', n=5)
    
    # 6. 날짜 컬럼 자동 변환
    df_datetime = read_with_datetime('sales_data.csv')
    
    # 7. 기본 통계
    print("\n📊 기본 통계")
    print("=" * 70)
    print(f"총 매출액: {df['총액'].sum():,}원")
    print(f"평균 주문 금액: {df['총액'].mean():,.0f}원")
    print(f"최고 주문 금액: {df['총액'].max():,}원")
    print(f"최저 주문 금액: {df['총액'].min():,}원")
```

### 추가 예제 1: 대용량 파일 청크 처리

```python
import pandas as pd

def process_large_csv_in_chunks(filename, chunk_size=100):
    """대용량 CSV를 청크 단위로 처리"""
    print(f"\n🔄 청크 단위 처리 (청크 크기: {chunk_size})")
    print("=" * 70)
    
    total_amount = 0
    chunk_count = 0
    
    # 청크 단위로 읽기
    for chunk in pd.read_csv(filename, chunksize=chunk_size, encoding='utf-8'):
        chunk_count += 1
        chunk_total = chunk['총액'].sum()
        total_amount += chunk_total
        
        print(f"청크 {chunk_count}: {len(chunk)}행, 합계 {chunk_total:,}원")
    
    print("=" * 70)
    print(f"전체 총액: {total_amount:,}원")
    print(f"처리한 청크 수: {chunk_count}개")


# 사용 예
process_large_csv_in_chunks('sales_data.csv', chunk_size=200)
```

### 추가 예제 2: 여러 CSV 파일 병합

```python
import pandas as pd
import glob

def merge_multiple_csv_files(pattern='sales_*.csv'):
    """여러 CSV 파일을 하나로 병합"""
    print(f"\n📁 여러 CSV 파일 병합")
    print("=" * 70)
    
    # 패턴에 맞는 모든 파일 찾기
    files = glob.glob(pattern)
    print(f"발견된 파일: {len(files)}개")
    
    if not files:
        print("❌ 파일을 찾을 수 없습니다.")
        return None
    
    # 모든 파일 읽어서 병합
    df_list = []
    for file in files:
        df = pd.read_csv(file, encoding='utf-8')
        df_list.append(df)
        print(f"  - {file}: {len(df)}행")
    
    # 병합
    merged_df = pd.concat(df_list, ignore_index=True)
    
    print("=" * 70)
    print(f"✅ 병합 완료: 총 {len(merged_df)}행")
    
    return merged_df


# 사용 예 (여러 파일이 있다면)
# merged = merge_multiple_csv_files('sales_*.csv')
```

### 추가 예제 3: 조건에 맞는 데이터만 읽기

```python
import pandas as pd

def read_csv_with_filter(filename, min_amount=100000):
    """특정 금액 이상의 주문만 읽기"""
    print(f"\n💰 {min_amount:,}원 이상 주문만 읽기")
    print("=" * 70)
    
    # 먼저 전체 읽기
    df = pd.read_csv(filename, encoding='utf-8')
    
    # 조건 필터링
    filtered_df = df[df['총액'] >= min_amount]
    
    print(f"전체 주문: {len(df)}건")
    print(f"필터된 주문: {len(filtered_df)}건")
    print(f"비율: {len(filtered_df)/len(df)*100:.1f}%\n")
    
    print(filtered_df.head(10))
    
    return filtered_df


# 사용 예
high_value_orders = read_csv_with_filter('sales_data.csv', min_amount=500000)
```

## 3) 코드 설명

### read_csv() vs csv 모듈

```python
# csv 모듈 (이전 교시)
import csv
with open('data.csv', 'r') as f:
    reader = csv.reader(f)
    for row in reader:
        print(row)  # 리스트

# Pandas (훨씬 강력!)
import pandas as pd
df = pd.read_csv('data.csv')
print(df)  # DataFrame (표 형태)
```

**Pandas의 장점**:
- 자동으로 데이터 타입 인식
- 인덱싱과 슬라이싱 지원
- 강력한 데이터 조작 기능
- 통계 함수 내장

### 인코딩 이해하기

```python
# UTF-8: 유니코드 표준 (권장)
df = pd.read_csv('data.csv', encoding='utf-8')

# CP949: 윈도우 한글 인코딩
df = pd.read_csv('data.csv', encoding='cp949')

# 자동 감지 (chardet 라이브러리 필요)
import chardet
with open('data.csv', 'rb') as f:
    result = chardet.detect(f.read())
    encoding = result['encoding']
df = pd.read_csv('data.csv', encoding=encoding)
```

### parse_dates 옵션

```python
# 날짜 문자열을 datetime 타입으로 자동 변환
df = pd.read_csv('data.csv', parse_dates=['날짜'])

# 여러 컬럼을 합쳐서 날짜로 변환
df = pd.read_csv('data.csv', parse_dates={'datetime': ['날짜', '시간']})
```

## 4) 실습 미션

### 미션 1: CSV 파일 정보 출력 (난이도: ★☆☆)

CSV 파일을 읽고 기본 정보를 출력하는 함수를 작성하세요.

**요구사항**:
- 함수명: `print_csv_info`
- 매개변수: `filename`
- 출력: 행 수, 열 수, 컬럼명, 데이터 타입

```python
def print_csv_info(filename):
    # 코드를 작성하세요
    pass

# 테스트
print_csv_info('sales_data.csv')
```

### 미션 2: 고객별 총 구매액 계산 (난이도: ★★☆)

매출 CSV를 읽어 고객별 총 구매액을 계산하는 함수를 작성하세요.

**요구사항**:
- 함수명: `calculate_customer_total`
- 매개변수: `filename`
- 반환값: 고객별 총액 DataFrame

```python
def calculate_customer_total(filename):
    # 코드를 작성하세요
    # 힌트: groupby() 사용
    pass

# 테스트
result = calculate_customer_total('sales_data.csv')
print(result)
```

### 미션 3: 월별 매출 분석 (난이도: ★★★)

매출 CSV를 읽어 월별 매출을 집계하는 함수를 작성하세요.

**요구사항**:
- 함수명: `analyze_monthly_sales`
- 매개변수: `filename`
- 반환값: 월별 매출, 주문 건수, 평균 주문 금액을 포함한 DataFrame

```python
def analyze_monthly_sales(filename):
    # 코드를 작성하세요
    # 힌트: 날짜에서 월 추출, groupby() 사용
    pass

# 테스트
result = analyze_monthly_sales('sales_data.csv')
print(result)
```

## 5) 퀴즈

### 퀴즈 1 (객관식)
Pandas에서 CSV 파일을 읽을 때 사용하는 함수는?

1. pd.read_file()
2. pd.load_csv()
3. pd.read_csv()
4. pd.open_csv()

### 퀴즈 2 (객관식)
CSV 파일에서 특정 컬럼만 읽으려면 어떤 파라미터를 사용하나요?

1. columns
2. usecols
3. select
4. fields

### 퀴즈 3 (단답형)
윈도우 엑셀에서 저장한 한글 CSV 파일이 깨질 때 시도해볼 인코딩은?

## 6) 정답 및 해설

### 미션 정답

**미션 1 정답**:
```python
import pandas as pd

def print_csv_info(filename):
    """CSV 파일 정보 출력"""
    df = pd.read_csv(filename, encoding='utf-8')
    
    print("=" * 70)
    print(f"📂 파일명: {filename}")
    print("=" * 70)
    print(f"행 수: {len(df):,}개")
    print(f"열 수: {len(df.columns)}개")
    print(f"\n컬럼명:")
    for i, col in enumerate(df.columns, 1):
        print(f"  {i}. {col}")
    print(f"\n데이터 타입:")
    print(df.dtypes)
    print("=" * 70)
```

**해설**: `read_csv()`로 파일을 읽은 후 DataFrame의 속성들을 출력합니다.

**미션 2 정답**:
```python
import pandas as pd

def calculate_customer_total(filename):
    """고객별 총 구매액 계산"""
    df = pd.read_csv(filename, encoding='utf-8')
    
    # 고객별 그룹화하여 총액 합계
    customer_total = df.groupby('고객명')['총액'].sum().reset_index()
    customer_total.columns = ['고객명', '총구매액']
    
    # 내림차순 정렬
    customer_total = customer_total.sort_values('총구매액', ascending=False)
    
    return customer_total
```

**해설**: `groupby()`로 고객별로 그룹화하고 `sum()`으로 총액을 합산합니다.

**미션 3 정답**:
```python
import pandas as pd

def analyze_monthly_sales(filename):
    """월별 매출 분석"""
    df = pd.read_csv(filename, encoding='utf-8', parse_dates=['날짜'])
    
    # 월 추출
    df['월'] = df['날짜'].dt.month
    
    # 월별 집계
    monthly = df.groupby('월').agg({
        '총액': ['sum', 'mean', 'count']
    }).reset_index()
    
    # 컬럼명 정리
    monthly.columns = ['월', '총매출', '평균주문금액', '주문건수']
    monthly['총매출'] = monthly['총매출'].astype(int)
    monthly['평균주문금액'] = monthly['평균주문금액'].astype(int)
    
    return monthly
```

**해설**: 날짜에서 월을 추출하고 `groupby()`와 `agg()`로 여러 통계를 한 번에 계산합니다.

### 퀴즈 정답

**퀴즈 1 정답**: 3. pd.read_csv()

**해설**: Pandas에서 CSV 파일을 읽을 때는 `read_csv()` 함수를 사용합니다.

**퀴즈 2 정답**: 2. usecols

**해설**: `usecols` 파라미터로 읽어올 컬럼을 선택할 수 있습니다.

**퀴즈 3 정답**: cp949 (또는 euc-kr)

**해설**: 윈도우 엑셀은 기본적으로 CP949 인코딩을 사용합니다.

---

# 7교시: DataFrame 분석 메서드

> **학습 목표**: head(), info(), describe()로 데이터프레임 요약 정보 확인 방법 이해  
> **실습 주제**: 불러온 데이터프레임의 행/열 개수 및 데이터 타입 확인 코드 작성

## 1) 이론 설명

### 데이터 분석의 첫 단계: 데이터 파악

데이터를 분석하기 전에 반드시 해야 할 일:
1. **데이터 구조 파악**: 몇 행, 몇 열인가?
2. **데이터 타입 확인**: 숫자인가, 문자인가?
3. **결측값 확인**: 빠진 데이터가 있는가?
4. **기본 통계 확인**: 평균, 최대, 최소값은?

Pandas는 이를 위한 강력한 메서드를 제공합니다!

### 주요 탐색 메서드

#### 1. head() / tail() - 데이터 미리보기

```python
df.head()      # 처음 5행
df.head(10)    # 처음 10행
df.tail()      # 마지막 5행
df.tail(10)    # 마지막 10행
```

**용도**: 데이터가 제대로 읽혔는지 빠르게 확인

#### 2. info() - 전체 구조 파악

```python
df.info()
```

**출력 정보**:
- 총 행 수
- 총 열 수
- 각 컬럼의 데이터 타입
- 결측값(Non-Null) 개수
- 메모리 사용량

**용도**: 데이터 구조와 타입, 결측값 한눈에 파악

#### 3. describe() - 기술 통계

```python
df.describe()              # 숫자형 컬럼만
df.describe(include='all')  # 모든 컬럼
```

**출력 정보**:
- count: 데이터 개수
- mean: 평균
- std: 표준편차
- min/max: 최소/최대값
- 25%, 50%, 75%: 사분위수

**용도**: 숫자 데이터의 분포 파악

#### 4. shape - 행/열 개수

```python
df.shape  # (행 수, 열 수) 튜플 반환
```

**용도**: 데이터 크기 확인

#### 5. columns - 컬럼명 확인

```python
df.columns          # Index 객체
df.columns.tolist()  # 리스트로 변환
```

**용도**: 어떤 컬럼이 있는지 확인

#### 6. dtypes - 데이터 타입 확인

```python
df.dtypes  # 각 컬럼의 데이터 타입
```

**주요 데이터 타입**:
- `int64`: 정수
- `float64`: 실수
- `object`: 문자열 (또는 혼합 타입)
- `datetime64`: 날짜/시간
- `bool`: 불리언 (True/False)

### 결측값 확인

```python
df.isnull()          # 결측값이면 True
df.isnull().sum()    # 컬럼별 결측값 개수
df.notnull()         # 결측값이 아니면 True
```

### 고유값 확인

```python
df['컬럼명'].unique()        # 고유값 배열
df['컬럼명'].nunique()       # 고유값 개수
df['컬럼명'].value_counts()  # 값별 빈도수
```

## 2) 실습 예제 코드

### 메인 실습: DataFrame 분석

```python
# ========================================
# 7교시 실습: DataFrame 분석 메서드
# ========================================

import pandas as pd
import numpy as np

# ===== 샘플 데이터 생성 (일부 결측값 포함) =====
def create_sample_data():
    """분석용 샘플 직원 데이터 생성"""
    np.random.seed(42)
    
    employees = {
        '사번': [f'E{i:03d}' for i in range(1, 51)],
        '이름': [f'직원{i}' for i in range(1, 51)],
        '부서': np.random.choice(['영업팀', '개발팀', '디자인팀', '인사팀'], 50),
        '직급': np.random.choice(['사원', '대리', '과장', '차장'], 50),
        '나이': np.random.randint(25, 50, 50),
        '연봉': np.random.randint(3000, 8000, 50) * 10000,
        '입사일': pd.date_range('2015-01-01', periods=50, freq='M')
    }
    
    df = pd.DataFrame(employees)
    
    # 일부 결측값 생성
    df.loc[5, '나이'] = np.nan
    df.loc[10, '연봉'] = np.nan
    df.loc[15, '부서'] = np.nan
    
    # CSV로 저장
    df.to_csv('employees.csv', index=False, encoding='utf-8')
    print("✅ 'employees.csv' 파일이 생성되었습니다.\n")
    
    return df


# ===== 1. head() / tail() - 데이터 미리보기 =====
def explore_head_tail(df):
    """데이터 미리보기"""
    print("=" * 70)
    print("📋 1. 데이터 미리보기 (head / tail)")
    print("=" * 70 + "\n")
    
    print("처음 5행:")
    print(df.head())
    print()
    
    print("마지막 3행:")
    print(df.tail(3))
    print()


# ===== 2. info() - 전체 구조 파악 =====
def explore_info(df):
    """DataFrame 구조 정보"""
    print("=" * 70)
    print("ℹ️ 2. DataFrame 구조 정보 (info)")
    print("=" * 70 + "\n")
    
    df.info()
    print()


# ===== 3. describe() - 기술 통계 =====
def explore_describe(df):
    """기술 통계"""
    print("=" * 70)
    print("📊 3. 기술 통계 (describe)")
    print("=" * 70 + "\n")
    
    print("숫자형 컬럼 통계:")
    print(df.describe())
    print()
    
    print("모든 컬럼 통계 (일부만 표시):")
    print(df[['부서', '직급']].describe())
    print()


# ===== 4. shape - 행/열 개수 =====
def explore_shape(df):
    """데이터 크기"""
    print("=" * 70)
    print("📏 4. 데이터 크기 (shape)")
    print("=" * 70 + "\n")
    
    rows, cols = df.shape
    print(f"행 수: {rows}개")
    print(f"열 수: {cols}개")
    print(f"총 셀 수: {rows * cols}개")
    print()


# ===== 5. columns - 컬럼명 확인 =====
def explore_columns(df):
    """컬럼 정보"""
    print("=" * 70)
    print("🏷️ 5. 컬럼 정보 (columns)")
    print("=" * 70 + "\n")
    
    print("컬럼 목록:")
    for i, col in enumerate(df.columns, 1):
        print(f"  {i}. {col}")
    print()


# ===== 6. dtypes - 데이터 타입 확인 =====
def explore_dtypes(df):
    """데이터 타입"""
    print("=" * 70)
    print("🔤 6. 데이터 타입 (dtypes)")
    print("=" * 70 + "\n")
    
    print("컬럼별 데이터 타입:")
    print(df.dtypes)
    print()
    
    # 타입별 개수
    print("타입별 컬럼 수:")
    print(df.dtypes.value_counts())
    print()


# ===== 7. 결측값 확인 =====
def explore_missing_values(df):
    """결측값 분석"""
    print("=" * 70)
    print("❓ 7. 결측값 확인 (isnull)")
    print("=" * 70 + "\n")
    
    print("컬럼별 결측값 개수:")
    missing = df.isnull().sum()
    print(missing[missing > 0])
    
    if missing.sum() == 0:
        print("결측값이 없습니다! ✅")
    else:
        print(f"\n총 결측값: {missing.sum()}개")
        print(f"결측 비율: {missing.sum() / (df.shape[0] * df.shape[1]) * 100:.2f}%")
    print()


# ===== 8. 고유값 확인 =====
def explore_unique_values(df):
    """고유값 분석"""
    print("=" * 70)
    print("🔍 8. 고유값 분석 (unique / value_counts)")
    print("=" * 70 + "\n")
    
    print("부서별 인원:")
    print(df['부서'].value_counts())
    print()
    
    print("직급별 인원:")
    print(df['직급'].value_counts())
    print()
    
    print(f"고유한 부서 수: {df['부서'].nunique()}개")
    print(f"고유한 직급 수: {df['직급'].nunique()}개")
    print()


# ===== 9. 종합 요약 =====
def comprehensive_summary(df):
    """종합 데이터 요약"""
    print("=" * 70)
    print("📑 종합 데이터 요약")
    print("=" * 70 + "\n")
    
    print(f"📂 데이터셋 크기: {df.shape[0]}행 × {df.shape[1]}열")
    print(f"💾 메모리 사용량: {df.memory_usage(deep=True).sum() / 1024:.2f} KB")
    print()
    
    print("📊 숫자형 컬럼 요약:")
    numeric_cols = df.select_dtypes(include=[np.number]).columns
    for col in numeric_cols:
        print(f"\n  [{col}]")
        print(f"    - 평균: {df[col].mean():.2f}")
        print(f"    - 중앙값: {df[col].median():.2f}")
        print(f"    - 최소: {df[col].min()}")
        print(f"    - 최대: {df[col].max()}")
        print(f"    - 결측: {df[col].isnull().sum()}개")
    
    print("\n🏷️ 범주형 컬럼 요약:")
    categorical_cols = df.select_dtypes(include=['object']).columns
    for col in categorical_cols:
        if col not in ['사번', '이름']:  # ID성 컬럼 제외
            print(f"\n  [{col}]")
            print(f"    - 고유값 수: {df[col].nunique()}개")
            print(f"    - 최빈값: {df[col].mode()[0] if not df[col].mode().empty else 'N/A'}")
            print(f"    - 결측: {df[col].isnull().sum()}개")
    print()


# ===== 프로그램 실행 =====
print("=" * 70)
print("DataFrame 분석 메서드 실습")
print("=" * 70 + "\n")

# 샘플 데이터 생성
df = create_sample_data()

# 또는 CSV에서 읽기
# df = pd.read_csv('employees.csv', encoding='utf-8')

# 각 메서드 실습
explore_head_tail(df)
explore_info(df)
explore_describe(df)
explore_shape(df)
explore_columns(df)
explore_dtypes(df)
explore_missing_values(df)
explore_unique_values(df)
comprehensive_summary(df)

print("=" * 70)
print("✅ 모든 분석 메서드 실습 완료!")
print("=" * 70)
```

### 추가 예제 1: 조건부 통계

```python
import pandas as pd

def conditional_statistics(df):
    """조건부 통계 분석"""
    print("\n📊 조건부 통계")
    print("=" * 70)
    
    # 부서별 평균 연봉
    print("부서별 평균 연봉:")
    print(df.groupby('부서')['연봉'].mean().sort_values(ascending=False))
    print()
    
    # 직급별 평균 나이
    print("직급별 평균 나이:")
    print(df.groupby('직급')['나이'].mean().sort_values())
    print()


conditional_statistics(df)
```

### 추가 예제 2: 데이터 품질 체크

```python
import pandas as pd

def data_quality_check(df):
    """데이터 품질 검사"""
    print("\n✅ 데이터 품질 검사")
    print("=" * 70)
    
    issues = []
    
    # 1. 결측값 확인
    missing = df.isnull().sum()
    if missing.sum() > 0:
        issues.append(f"결측값 발견: {missing.sum()}개")
    
    # 2. 중복 행 확인
    duplicates = df.duplicated().sum()
    if duplicates > 0:
        issues.append(f"중복 행 발견: {duplicates}개")
    
    # 3. 이상값 확인 (나이가 100세 이상 또는 0 이하)
    if 'nagie' in df.columns:
        age_issues = ((df['나이'] > 100) | (df['나이'] <= 0)).sum()
        if age_issues > 0:
            issues.append(f"이상한 나이 값: {age_issues}개")
    
    # 결과 출력
    if issues:
        print("⚠️ 발견된 문제:")
        for i, issue in enumerate(issues, 1):
            print(f"  {i}. {issue}")
    else:
        print("✅ 데이터 품질 양호!")
    print()


data_quality_check(df)
```

## 3) 코드 설명

### describe()의 통계 지표 이해

```python
df.describe()
```

**출력 지표**:
- **count**: 결측값을 제외한 데이터 개수
- **mean**: 평균 = 합계 ÷ 개수
- **std**: 표준편차 = 데이터 분산 정도
- **min/max**: 최소값/최대값
- **25%/50%/75%**: 사분위수
  - 25%: 하위 25% 지점 값
  - 50%: 중앙값 (중간 값)
  - 75%: 상위 25% 지점 값

### info()가 보여주는 정보

```python
df.info()
```

**주요 출력**:
```
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 50 entries, 0 to 49  ← 인덱스 범위
Data columns (total 7 columns):   ← 총 컬럼 수
 #   Column  Non-Null Count  Dtype   ← 컬럼별 정보
---  ------  --------------  -----  
 0   사번    50 non-null     object  ← 결측값 없음
 1   이름    50 non-null     object
 2   부서    49 non-null     object  ← 결측값 1개
 3   나이    49 non-null     float64 ← 결측값 1개
...
dtypes: float64(2), object(5)    ← 타입별 개수
memory usage: 2.9+ KB            ← 메모리 사용량
```

### value_counts()의 활용

```python
# 빈도수 (내림차순)
df['부서'].value_counts()

# 비율 (%)
df['부서'].value_counts(normalize=True) * 100

# 결측값 포함
df['부서'].value_counts(dropna=False)
```

## 4) 실습 미션

### 미션 1: 데이터 요약 함수 (난이도: ★☆☆)

DataFrame의 기본 정보를 한 번에 출력하는 함수를 작성하세요.

**요구사항**:
- 함수명: `summarize_dataframe`
- 매개변수: `df`
- 출력: 행/열 수, 결측값 개수, 데이터 타입

```python
def summarize_dataframe(df):
    # 코드를 작성하세요
    pass

# 테스트
df = pd.read_csv('employees.csv', encoding='utf-8')
summarize_dataframe(df)
```

### 미션 2: 숫자 컬럼 통계 (난이도: ★★☆)

숫자형 컬럼만 선택하여 통계를 계산하는 함수를 작성하세요.

**요구사항**:
- 함수명: `numeric_summary`
- 매개변수: `df`
- 반환값: 숫자 컬럼의 평균, 최소, 최대를 포함한 DataFrame

```python
def numeric_summary(df):
    # 코드를 작성하세요
    # 힌트: select_dtypes() 사용
    pass

# 테스트
result = numeric_summary(df)
print(result)
```

### 미션 3: 데이터 프로파일링 리포트 (난이도: ★★★)

전체 데이터의 상세 프로파일을 생성하는 함수를 작성하세요.

**요구사항**:
- 함수명: `data_profiling_report`
- 매개변수: `df`, `filename` (리포트 저장 파일명)
- 기능: 
  - 데이터 크기
  - 컬럼별 통계
  - 결측값 분석
  - 고유값 분석
  - 결과를 텍스트 파일로 저장

```python
def data_profiling_report(df, filename='data_profile.txt'):
    # 코드를 작성하세요
    pass

# 테스트
data_profiling_report(df, 'employee_profile.txt')
```

## 5) 퀴즈

### 퀴즈 1 (객관식)
DataFrame의 처음 10행을 보려면?

1. df.show(10)
2. df.head(10)
3. df.first(10)
4. df.top(10)

### 퀴즈 2 (객관식)
결측값의 개수를 확인하는 방법은?

1. df.missing().sum()
2. df.isnull().sum()
3. df.empty().sum()
4. df.na().sum()

### 퀴즈 3 (단답형)
DataFrame의 행과 열의 개수를 튜플로 반환하는 속성은?

## 6) 정답 및 해설

### 미션 정답

**미션 1 정답**:
```python
import pandas as pd

def summarize_dataframe(df):
    """DataFrame 요약 정보 출력"""
    print("=" * 70)
    print("📊 DataFrame 요약")
    print("=" * 70)
    
    # 기본 정보
    rows, cols = df.shape
    print(f"\n데이터 크기: {rows}행 × {cols}열")
    
    # 결측값
    total_missing = df.isnull().sum().sum()
    print(f"총 결측값: {total_missing}개")
    
    if total_missing > 0:
        print("\n컬럼별 결측값:")
        missing = df.isnull().sum()
        print(missing[missing > 0])
    
    # 데이터 타입
    print("\n데이터 타입:")
    print(df.dtypes.value_counts())
    
    print("=" * 70)
```

**해설**: shape, isnull(), dtypes를 활용하여 핵심 정보를 요약합니다.

**미션 2 정답**:
```python
import pandas as pd
import numpy as np

def numeric_summary(df):
    """숫자형 컬럼 통계"""
    # 숫자형 컬럼만 선택
    numeric_df = df.select_dtypes(include=[np.number])
    
    # 통계 계산
    summary = pd.DataFrame({
        '평균': numeric_df.mean(),
        '최소': numeric_df.min(),
        '최대': numeric_df.max(),
        '중앙값': numeric_df.median(),
        '표준편차': numeric_df.std()
    })
    
    return summary.round(2)
```

**해설**: `select_dtypes()`로 숫자 컬럼을 선택하고 통계 함수를 적용합니다.

**미션 3 정답**:
```python
import pandas as pd
import numpy as np
from datetime import datetime

def data_profiling_report(df, filename='data_profile.txt'):
    """데이터 프로파일링 리포트 생성"""
    with open(filename, 'w', encoding='utf-8') as f:
        # 헤더
        f.write("=" * 70 + "\n")
        f.write("데이터 프로파일링 리포트\n")
        f.write(f"생성 시간: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write("=" * 70 + "\n\n")
        
        # 1. 데이터 크기
        f.write("1. 데이터 크기\n")
        f.write("-" * 70 + "\n")
        rows, cols = df.shape
        f.write(f"행 수: {rows:,}개\n")
        f.write(f"열 수: {cols}개\n")
        f.write(f"총 셀 수: {rows * cols:,}개\n\n")
        
        # 2. 컬럼 정보
        f.write("2. 컬럼 정보\n")
        f.write("-" * 70 + "\n")
        for i, col in enumerate(df.columns, 1):
            dtype = df[col].dtype
            non_null = df[col].notnull().sum()
            f.write(f"{i}. {col} ({dtype}) - {non_null}/{rows}개\n")
        f.write("\n")
        
        # 3. 결측값 분석
        f.write("3. 결측값 분석\n")
        f.write("-" * 70 + "\n")
        missing = df.isnull().sum()
        total_missing = missing.sum()
        f.write(f"총 결측값: {total_missing}개\n")
        if total_missing > 0:
            f.write("\n컬럼별 결측값:\n")
            for col in missing[missing > 0].index:
                count = missing[col]
                pct = count / rows * 100
                f.write(f"  - {col}: {count}개 ({pct:.1f}%)\n")
        f.write("\n")
        
        # 4. 숫자형 컬럼 통계
        f.write("4. 숫자형 컬럼 통계\n")
        f.write("-" * 70 + "\n")
        numeric_cols = df.select_dtypes(include=[np.number]).columns
        for col in numeric_cols:
            f.write(f"\n[{col}]\n")
            f.write(f"  평균: {df[col].mean():.2f}\n")
            f.write(f"  중앙값: {df[col].median():.2f}\n")
            f.write(f"  최소: {df[col].min()}\n")
            f.write(f"  최대: {df[col].max()}\n")
            f.write(f"  표준편차: {df[col].std():.2f}\n")
        f.write("\n")
        
        # 5. 범주형 컬럼 분석
        f.write("5. 범주형 컬럼 분석\n")
        f.write("-" * 70 + "\n")
        categorical_cols = df.select_dtypes(include=['object']).columns
        for col in categorical_cols:
            f.write(f"\n[{col}]\n")
            f.write(f"  고유값 수: {df[col].nunique()}개\n")
            value_counts = df[col].value_counts()
            f.write(f"  최빈값: {value_counts.index[0]} ({value_counts.iloc[0]}개)\n")
        
        f.write("\n" + "=" * 70 + "\n")
    
    print(f"✅ 프로파일링 리포트가 '{filename}'에 저장되었습니다.")
```

**해설**: 다양한 분석 메서드를 조합하여 종합 리포트를 생성합니다.

### 퀴즈 정답

**퀴즈 1 정답**: 2. df.head(10)

**해설**: `head()` 메서드는 DataFrame의 처음 N행을 반환합니다.

**퀴즈 2 정답**: 2. df.isnull().sum()

**해설**: `isnull()`로 결측값을 찾고 `sum()`으로 개수를 셉니다.

**퀴즈 3 정답**: shape

**해설**: `df.shape`는 (행 수, 열 수) 튜플을 반환합니다.

---

# �� 7교시 완성형 커리큘럼 완료!

축하합니다! 직장인을 위한 파이썬 기초 7교시 과정을 모두 마쳤습니다.

## 📚 학습한 내용 요약

1. **1교시: 함수** - 코드 재사용과 환율 계산
2. **2교시: 파일 I/O** - 텍스트 파일 읽기/쓰기
3. **3교시: CSV** - CSV 파일 처리
4. **4교시: JSON** - JSON 데이터 다루기
5. **5교시: Pandas 기초** - DataFrame 생성
6. **6교시: CSV 읽기** - read_csv()로 대용량 데이터 처리
7. **7교시: 데이터 분석** - head(), info(), describe()

## 🚀 다음 단계

이제 여러분은 실무에서 필요한 파이썬 기초를 모두 갖추었습니다!

**추천 다음 학습 주제**:
1. **Pandas 고급**: groupby, merge, pivot_table
2. **데이터 시각화**: matplotlib, seaborn
3. **데이터 전처리**: 결측값 처리, 이상값 제거
4. **자동화**: 반복 작업 자동화 스크립트
5. **웹 스크래핑**: requests, BeautifulSoup

## 💼 실무 활용 예시

**엑셀 업무 자동화**:
- 여러 엑셀 파일 자동 병합
- 월간 리포트 자동 생성
- 데이터 정제 및 변환

**데이터 분석**:
- 매출 데이터 분석
- 고객 세분화
- 트렌드 분석

**업무 자동화**:
- 이메일 자동 발송
- 파일 정리 및 백업
- 로그 분석

---

**여러분의 파이썬 학습을 응원합니다! 🎯**

**계속해서 실습하고, 실전 프로젝트를 만들어보세요!**
